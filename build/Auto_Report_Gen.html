

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Automation Correlation and Cpk Report Documentation &mdash; Automation Correlation and Cpk Report 1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="_static/drawio.css?v=25a831d2" />
      <link rel="stylesheet" type="text/css" href="_static/nbsphinx-code-cells.css?v=2aa19091" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=f2a433a1"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
      <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
      <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Flowchart Documentation" href="flowchart.html" />
    <link rel="prev" title="Methodology" href="methodology.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            Automation Correlation and Cpk Report
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="project_overview.html">Project Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="methodology.html">Methodology</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Automation Correlation and Cpk Report Documentation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Import-Package">Import Package</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Deploy-Function">Deploy Function</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Clear-console-function">Clear console function</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Display-intro-banner-function">Display intro banner function</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Display-thank-you-function">Display thank you function</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Get-product-information-function">Get product information function</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Get-setup-information-function">Get setup information function</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Get-data-for-New-Boards-(NB),-Reference-Boards-(RB)-and-Limit-file-function">Get data for New Boards (NB), Reference Boards (RB) and Limit file function</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Dataframe-cleanup-process-function">Dataframe cleanup process function</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Mean-shift-calculation-function">Mean shift calculation function</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Mean-shift-criteria-decision-function">Mean shift criteria decision function</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Standard-deviation-ratio-calculation">Standard deviation ratio calculation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Standard-deviation-criteria-decision-function">Standard deviation criteria decision function</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Evaluation-status-function">Evaluation status function</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Cp-Calculation-for-RB">Cp Calculation for RB</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Cpk-Calculation-for-RB">Cpk Calculation for RB</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Cp-Calculation-for-NB">Cp Calculation for NB</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Cpk-Calculation-for-NB">Cpk Calculation for NB</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Check-value-based-on-number-of-failure-test-function">Check value based on number of failure test function</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Autofit-column-for-generate-report">Autofit column for generate report</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#Display-Banner-&amp;-Asking-Input">Display Banner &amp; Asking Input</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Data-Processing">Data Processing</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Read-and-Data-processing-for-Limit-file">Read and Data processing for Limit file</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Read-RB-for-all-units">Read RB for all units</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Read-all-NB-for-all-units">Read all NB for all units</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Data-processing-for-all-NBs-and-RB-for-all-units">Data processing for all NBs and RB for all units</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#Correlation-Report">Correlation Report</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Calculate-mean-and-standard-deviation-for-RB-for-all-units">Calculate mean and standard deviation for RB for all units</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Calculate-mean-and-standard-deviation-for-all-NBs-for-all-units">Calculate mean and standard deviation for all NBs for all units</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Create-dataframe-for-limit-and-RB-for-all-units">Create dataframe for limit and RB for all units</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Create-and-Analyzing-DataFrames-all-NBS-for-all-Units">Create and Analyzing DataFrames all NBS for all Units</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Store-all-NBs-based-on-Unit-Results-and-Overall-NBs-Status">Store all NBs based on Unit Results and Overall NBs Status</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Combine-Limits-with-all-NBs-Results">Combine Limits with all NBs Results</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#Cpk-Report">Cpk Report</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Combine-Unit-Results-for-RB-and-all-NBs-into-a-Single-DataFrame-respectively">Combine Unit Results for RB and all NBs into a Single DataFrame respectively</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Calculate-Mean-for-RB-and-all-NBs-for-DataFrames">Calculate Mean for RB and all NBs for DataFrames</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Calculate-Standard-Deviation-for-RB-and-all-NBs-for-DataFrames">Calculate Standard Deviation for RB and all NBs for DataFrames</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Combine-Mean-and-Standard-Deviation-for-RB-and-NBs">Combine Mean and Standard Deviation for RB and NBs</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Calculate-Cp-and-Cpk-for-RB">Calculate Cp and Cpk for RB</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Calculate-Cp-and-Cpk-for-NBs">Calculate Cp and Cpk for NBs</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#Correlation-Result-Summary-Table">Correlation Result Summary Table</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Create-a-Correlation-Table-for-Test-Results-for-RB-and-all-NBs">Create a Correlation Table for Test Results for RB and all NBs</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Create-DataFrames-from-Product-and-Setup-Information">Create DataFrames from Product and Setup Information</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#Generate-output-file">Generate output file</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Display-thank-you-and-countdown-timer-with-exit">Display thank you and countdown timer with exit</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="flowchart.html">Flowchart Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="tool.html">Tool</a></li>
<li class="toctree-l1"><a class="reference internal" href="user_manual.html">User Manual</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Automation Correlation and Cpk Report</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Automation Correlation and Cpk Report Documentation</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/Auto_Report_Gen.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="Automation-Correlation-and-Cpk-Report-Documentation">
<h1>Automation Correlation and Cpk Report Documentation<a class="headerlink" href="#Automation-Correlation-and-Cpk-Report-Documentation" title="Link to this heading"></a></h1>
<section id="Import-Package">
<h2>Import Package<a class="headerlink" href="#Import-Package" title="Link to this heading"></a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import necessary libraries</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>  <span class="c1"># For data manipulation</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>  <span class="c1"># For numerical operations</span>
<span class="kn">import</span> <span class="nn">warnings</span>  <span class="c1"># To handle warnings</span>
<span class="kn">import</span> <span class="nn">sys</span>  <span class="c1"># For system-related functions</span>
<span class="kn">import</span> <span class="nn">os</span>  <span class="c1"># For operating system tasks</span>
<span class="kn">import</span> <span class="nn">platform</span>  <span class="c1"># For platform information</span>
<span class="kn">import</span> <span class="nn">time</span>  <span class="c1"># For time-related functions</span>
<span class="kn">from</span> <span class="nn">colorama</span> <span class="kn">import</span> <span class="n">Fore</span>  <span class="c1"># For colored text in the terminal</span>
<span class="kn">from</span> <span class="nn">openpyxl</span> <span class="kn">import</span> <span class="n">Workbook</span>  <span class="c1"># For working with Excel files</span>
<span class="kn">from</span> <span class="nn">openpyxl.utils</span> <span class="kn">import</span> <span class="n">get_column_letter</span>  <span class="c1"># To convert column numbers to letters</span>
<span class="kn">from</span> <span class="nn">openpyxl.styles</span> <span class="kn">import</span> <span class="n">Border</span><span class="p">,</span> <span class="n">Side</span><span class="p">,</span> <span class="n">Font</span><span class="p">,</span> <span class="n">Alignment</span><span class="p">,</span> <span class="n">PatternFill</span>  <span class="c1"># For styling Excel cells</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>  <span class="c1"># For date and time handling</span>

<span class="c1"># Ignore warnings to keep output clean</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="Deploy-Function">
<h2>Deploy Function<a class="headerlink" href="#Deploy-Function" title="Link to this heading"></a></h2>
<section id="Clear-console-function">
<h3>Clear console function<a class="headerlink" href="#Clear-console-function" title="Link to this heading"></a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">clear_console</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Clear the console screen.</span>

<span class="sd">    This function checks the operating system and executes the appropriate command</span>
<span class="sd">    to clear the console. It uses &#39;cls&#39; for Windows and &#39;clear&#39; for Unix/Linux/Mac.</span>

<span class="sd">    Returns:</span>
<span class="sd">        None</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">platform</span><span class="o">.</span><span class="n">system</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;Windows&quot;</span><span class="p">:</span>
        <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s1">&#39;cls&#39;</span><span class="p">)</span>  <span class="c1"># For Windows</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s1">&#39;clear&#39;</span><span class="p">)</span>  <span class="c1"># For Unix/Linux/Mac</span>
</pre></div>
</div>
</div>
</section>
<section id="Display-intro-banner-function">
<h3>Display intro banner function<a class="headerlink" href="#Display-intro-banner-function" title="Link to this heading"></a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">display_banner</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Display a decorative banner in the console.</span>

<span class="sd">    This function prints a stylized banner that includes information about the</span>
<span class="sd">    Auto Correlation and Cpk Report Generator, along with the author&#39;s name,</span>
<span class="sd">    email, and GitHub link. The banner is displayed in cyan color and is followed</span>
<span class="sd">    by a brief pause.</span>

<span class="sd">    Returns:</span>
<span class="sd">        None</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">banner</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">┏┓       ┏┓        ┓   •           ┓  ┏┓  ┓   ┳┓           ┏┓</span>
<span class="s1">┣┫┓┏╋┏┓  ┃ ┏┓┏┓┏┓┏┓┃┏┓╋┓┏┓┏┓  ┏┓┏┓┏┫  ┃ ┏┓┃┏  ┣┫┏┓┏┓┏┓┏┓╋  ┃┓┏┓┏┓┏┓┏┓┏┓╋┏┓┏┓</span>
<span class="s1">┛┗┗┻┗┗┛  ┗┛┗┛┛ ┛ ┗ ┗┗┻┗┗┗┛┛┗  ┗┻┛┗┗┻  ┗┛┣┛┛┗  ┛┗┗ ┣┛┗┛┛ ┗  ┗┛┗ ┛┗┗ ┛ ┗┻┗┗┛┛</span>
<span class="s1">                                        ┛         ┛</span>
<span class="s1">Auto Correlation and Cpk Report Generator</span>
<span class="s1">Coded by Mohamad Haikal bin Mohamad Nazari</span>
<span class="s1">Email: mohamadhaikal.mohamadnazari@tessolve.com</span>
<span class="s1">Github: https://github.com/haikal5e</span>
<span class="s1">    &#39;&#39;&#39;</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">Fore</span><span class="o">.</span><span class="n">CYAN</span><span class="si">}{</span><span class="n">banner</span><span class="si">}{</span><span class="n">Fore</span><span class="o">.</span><span class="n">RESET</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="Display-thank-you-function">
<h3>Display thank you function<a class="headerlink" href="#Display-thank-you-function" title="Link to this heading"></a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">thank_you</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Display a thank you message in the console.</span>

<span class="sd">    This function prints a stylized thank you message in green color. The message</span>
<span class="sd">    is displayed in a decorative format and is followed by a brief pause.</span>

<span class="sd">    Returns:</span>
<span class="sd">        None</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">thank</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">┏┳┓┓     ┓   ┓┏</span>
<span class="s1"> ┃ ┣┓┏┓┏┓┃┏  ┗┫┏┓┓┏</span>
<span class="s1"> ┻ ┛┗┗┻┛┗┛┗  ┗┛┗┛┗┻</span>

<span class="s1">    &#39;&#39;&#39;</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">Fore</span><span class="o">.</span><span class="n">GREEN</span><span class="si">}{</span><span class="n">thank</span><span class="si">}{</span><span class="n">Fore</span><span class="o">.</span><span class="n">RESET</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="Get-product-information-function">
<h3>Get product information function<a class="headerlink" href="#Get-product-information-function" title="Link to this heading"></a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_product_information</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Collect and manage product information with user verification.</span>

<span class="sd">    This function prompts the user to enter various product details, including</span>
<span class="sd">    the test card name, part name, package, lead count, and description. It</span>
<span class="sd">    ensures that the user cannot leave any fields empty and allows for</span>
<span class="sd">    reviewing and modifying the entered information before final confirmation.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict: A dictionary containing the collected product information.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Initialize product information dictionary</span>
    <span class="n">product_info</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;Test Card Name&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Part Name&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Package&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Lead Count&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Description&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span>
    <span class="p">}</span>

    <span class="c1"># Collect initial product information</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Please enter the following product information:&quot;</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">product_info</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Enter </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">: &quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">value</span><span class="p">:</span>
                <span class="n">product_info</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
                <span class="k">break</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">()</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2"> cannot be empty. Please try again.&quot;</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">()</span>  <span class="c1"># Retained for separation</span>

    <span class="c1"># Review and confirmation loop</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">clear_console</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Current Product Information:&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">product_info</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="c1"># Confirmation and change option</span>
        <span class="n">confirm</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Are you satisfied with the current information? (yes/no): &quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">confirm</span> <span class="o">==</span> <span class="s1">&#39;yes&#39;</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">()</span>  <span class="c1"># Retained for separation</span>
            <span class="k">break</span>
        <span class="k">elif</span> <span class="n">confirm</span> <span class="o">==</span> <span class="s1">&#39;no&#39;</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">()</span>  <span class="c1"># Retained for separation</span>
            <span class="c1"># Allow specific field changes</span>
            <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
                <span class="n">clear_console</span><span class="p">()</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Current Product Information:&quot;</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">product_info</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">()</span>  <span class="c1"># Retained for separation</span>

                <span class="c1"># Field selection for modification</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Which field would you like to change?&quot;</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">product_info</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> <span class="mi">1</span><span class="p">):</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">. </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;0. Go back to confirmation&quot;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">()</span>  <span class="c1"># Retained for separation</span>

                <span class="k">try</span><span class="p">:</span>
                    <span class="n">choice</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Enter the number of the field you want to modify: &quot;</span><span class="p">))</span>

                    <span class="c1"># print()  # Retained for separation</span>

                    <span class="k">if</span> <span class="n">choice</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="k">break</span>
                    <span class="k">elif</span> <span class="mi">1</span> <span class="o">&lt;=</span> <span class="n">choice</span> <span class="o">&lt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">product_info</span><span class="p">):</span>
                        <span class="n">field</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">product_info</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="n">choice</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
                        <span class="nb">print</span><span class="p">()</span>  <span class="c1"># Retained for separation</span>
                        <span class="n">new_value</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Enter new </span><span class="si">{</span><span class="n">field</span><span class="si">}</span><span class="s2">: &quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>

                        <span class="c1"># Validate input</span>
                        <span class="k">if</span> <span class="n">new_value</span><span class="p">:</span>
                            <span class="n">product_info</span><span class="p">[</span><span class="n">field</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_value</span>
                            <span class="nb">print</span><span class="p">()</span>  <span class="c1"># Retained for separation</span>
                            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">field</span><span class="si">}</span><span class="s2"> updated successfully!&quot;</span><span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="nb">print</span><span class="p">()</span>  <span class="c1"># Retained for separation</span>
                            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Invalid input. Field cannot be empty.&quot;</span><span class="p">)</span>

                        <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Press Enter to continue...</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">()</span>  <span class="c1"># Retained for separation</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Invalid choice. Please try again.&quot;</span><span class="p">)</span>
                        <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Press Enter to continue...</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

                <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">()</span>  <span class="c1"># Retained for separation</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Please enter a valid number.&quot;</span><span class="p">)</span>
                    <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Press Enter to continue...</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">()</span>  <span class="c1"># Retained for separation</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Invalid input. Please enter &#39;yes&#39; or &#39;no&#39;.&quot;</span><span class="p">)</span>
            <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Press Enter to continue...</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">product_info</span>
</pre></div>
</div>
</div>
</section>
<section id="Get-setup-information-function">
<h3>Get setup information function<a class="headerlink" href="#Get-setup-information-function" title="Link to this heading"></a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_setup_information</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Collect and manage setup information with user verification.</span>

<span class="sd">    This function prompts the user to enter various setup details, including</span>
<span class="sd">    the tester ID, reference board, new board ID, and test program. It ensures</span>
<span class="sd">    that the user cannot leave any fields empty and allows for reviewing and</span>
<span class="sd">    modifying the entered information before final confirmation.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict: A dictionary containing the collected setup information.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">clear_console</span><span class="p">()</span>

    <span class="c1"># Initialize setup information dictionary</span>
    <span class="n">setup_info</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;Tester ID&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Reference Board&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
        <span class="s1">&#39;New Board ID&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Test Program&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span>
    <span class="p">}</span>

    <span class="c1"># Collect initial setup information</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Please enter the following setup information:&quot;</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">setup_info</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Enter </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">: &quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">value</span><span class="p">:</span>
                <span class="n">setup_info</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
                <span class="k">break</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">()</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2"> cannot be empty. Please try again.&quot;</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">()</span>  <span class="c1"># Retained for separation</span>

    <span class="c1"># Review and confirmation loop</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">clear_console</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Current Setup Information:&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">setup_info</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="c1"># Confirmation and change option</span>
        <span class="n">confirm</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Are you satisfied with the current setup information? (yes/no): &quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">confirm</span> <span class="o">==</span> <span class="s1">&#39;yes&#39;</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">()</span>  <span class="c1"># Retained for separation</span>
            <span class="k">break</span>
        <span class="k">elif</span> <span class="n">confirm</span> <span class="o">==</span> <span class="s1">&#39;no&#39;</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">()</span>  <span class="c1"># Retained for separation</span>
            <span class="c1"># Allow specific field changes</span>
            <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
                <span class="n">clear_console</span><span class="p">()</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Current Setup Information:&quot;</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">setup_info</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">()</span>  <span class="c1"># Retained for separation</span>

                <span class="c1"># Field selection for modification</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Which field would you like to change?&quot;</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">setup_info</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> <span class="mi">1</span><span class="p">):</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">. </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;0. Go back to confirmation&quot;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">()</span>  <span class="c1"># Retained for separation</span>

                <span class="k">try</span><span class="p">:</span>
                    <span class="n">choice</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Enter the number of the field you want to modify: &quot;</span><span class="p">))</span>

                    <span class="k">if</span> <span class="n">choice</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="k">break</span>
                    <span class="k">elif</span> <span class="mi">1</span> <span class="o">&lt;=</span> <span class="n">choice</span> <span class="o">&lt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">setup_info</span><span class="p">):</span>
                        <span class="nb">print</span><span class="p">()</span>  <span class="c1"># Retained for separation</span>
                        <span class="n">field</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">setup_info</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="n">choice</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
                        <span class="n">new_value</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Enter new </span><span class="si">{</span><span class="n">field</span><span class="si">}</span><span class="s2">: &quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>

                        <span class="c1"># Validate input</span>
                        <span class="k">if</span> <span class="n">new_value</span><span class="p">:</span>
                            <span class="n">setup_info</span><span class="p">[</span><span class="n">field</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_value</span>
                            <span class="nb">print</span><span class="p">()</span>
                            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">field</span><span class="si">}</span><span class="s2"> updated successfully!&quot;</span><span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Invalid input. Field cannot be empty.&quot;</span><span class="p">)</span>

                        <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Press Enter to continue...</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Invalid choice. Please try again.&quot;</span><span class="p">)</span>
                        <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Press Enter to continue...</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

                <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Please enter a valid number.&quot;</span><span class="p">)</span>
                    <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Press Enter to continue...</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Invalid input. Please enter &#39;yes&#39; or &#39;no&#39;.&quot;</span><span class="p">)</span>
            <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Press Enter to continue...</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">setup_info</span>
</pre></div>
</div>
</div>
</section>
<section id="Get-data-for-New-Boards-(NB),-Reference-Boards-(RB)-and-Limit-file-function">
<h3>Get data for New Boards (NB), Reference Boards (RB) and Limit file function<a class="headerlink" href="#Get-data-for-New-Boards-(NB),-Reference-Boards-(RB)-and-Limit-file-function" title="Link to this heading"></a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_data</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Gets input from the user about boards, units, and RB units, and returns file path lists.</span>

<span class="sd">    This function prompts the user to enter the number of new boards and units tested,</span>
<span class="sd">    ensuring the values are between 1 and 9. It collects file paths for each board and</span>
<span class="sd">    unit, as well as a limit file path, and allows the user to review and modify the</span>
<span class="sd">    entered paths before final confirmation.</span>

<span class="sd">    Returns:</span>
<span class="sd">        tuple: A tuple containing:</span>
<span class="sd">            - list: A list of lists with file paths for each board and unit.</span>
<span class="sd">            - list: A list of file paths for RB units.</span>
<span class="sd">            - int: The number of boards.</span>
<span class="sd">            - int: The number of units.</span>
<span class="sd">            - str: The file path for the limit file.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">clear_console</span><span class="p">()</span>  <span class="c1"># Clear console at the start of the function</span>

    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">num_boards</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Enter the number of New Boards (NB) (between 1 and 9): &quot;</span><span class="p">))</span>
            <span class="k">if</span> <span class="mi">1</span> <span class="o">&lt;=</span> <span class="n">num_boards</span> <span class="o">&lt;=</span> <span class="mi">9</span><span class="p">:</span>  <span class="c1"># Check if the number is between 1 and 9</span>
                <span class="k">break</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">clear_console</span><span class="p">()</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Please enter a number between 1 and 9!&quot;</span><span class="p">)</span>
                <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="n">clear_console</span><span class="p">()</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Invalid input. Please enter a valid number!&quot;</span><span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>

    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">num_units</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Enter the number of units tested (between 1 and 9): &quot;</span><span class="p">))</span>
            <span class="k">if</span> <span class="mi">1</span> <span class="o">&lt;=</span> <span class="n">num_units</span> <span class="o">&lt;=</span> <span class="mi">9</span><span class="p">:</span>  <span class="c1"># Check if the number is between 1 and 9</span>
                <span class="k">break</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Please enter a number between 1 and 9!&quot;</span><span class="p">)</span>
                <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Invalid input. Please enter a valid number!&quot;</span><span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>

    <span class="c1"># Confirmation step</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">clear_console</span><span class="p">()</span>
        <span class="n">confirmation</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;You entered </span><span class="si">{</span><span class="n">num_boards</span><span class="si">}</span><span class="s2"> boards and </span><span class="si">{</span><span class="n">num_units</span><span class="si">}</span><span class="s2"> units. Are you sure these amounts are correct? (yes/no): &quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">confirmation</span> <span class="o">==</span> <span class="s1">&#39;yes&#39;</span><span class="p">:</span>
            <span class="k">break</span>
        <span class="k">elif</span> <span class="n">confirmation</span> <span class="o">==</span> <span class="s1">&#39;no&#39;</span><span class="p">:</span>
            <span class="n">clear_console</span><span class="p">()</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Let&#39;s enter the amounts again.&quot;</span><span class="p">)</span>
            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">1.5</span><span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>

            <span class="c1"># Reset the input for number of boards and units</span>
            <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
                <span class="n">clear_console</span><span class="p">()</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">num_boards</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Enter the number of New Boards (NB) (between 1 and 9): &quot;</span><span class="p">))</span>
                    <span class="k">if</span> <span class="mi">1</span> <span class="o">&lt;=</span> <span class="n">num_boards</span> <span class="o">&lt;=</span> <span class="mi">9</span><span class="p">:</span>  <span class="c1"># Check if the number is between 1 and 9</span>
                        <span class="k">break</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Please enter a number between 1 and 9!&quot;</span><span class="p">)</span>
                        <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
                <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Invalid input. Please enter a valid number!&quot;</span><span class="p">)</span>
                    <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>

            <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">num_units</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Enter the number of units tested (between 1 and 9): &quot;</span><span class="p">))</span>
                    <span class="k">if</span> <span class="mi">1</span> <span class="o">&lt;=</span> <span class="n">num_units</span> <span class="o">&lt;=</span> <span class="mi">9</span><span class="p">:</span>  <span class="c1"># Check if the number is between 1 and 9</span>
                        <span class="k">break</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Please enter a number between 1 and 9!&quot;</span><span class="p">)</span>
                        <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
                <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Invalid input. Please enter a valid number!&quot;</span><span class="p">)</span>
                    <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
            <span class="k">continue</span>  <span class="c1"># Go back to the confirmation step after resetting the values</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">clear_console</span><span class="p">()</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Invalid input. Please enter &#39;yes&#39; or &#39;no&#39;.&quot;</span><span class="p">)</span>
            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">1.5</span><span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>

    <span class="nb">print</span><span class="p">()</span>  <span class="c1"># Necessary for spacing</span>

    <span class="n">board_file_paths</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">board_num</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_boards</span><span class="p">):</span>  <span class="c1"># Range starts from 0</span>
        <span class="n">board_paths</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">unit_num</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_units</span><span class="p">):</span>  <span class="c1"># Range starts from 0</span>
            <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
                <span class="n">file_path</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Enter the file path for NB</span><span class="si">{</span><span class="n">board_num</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2"> U</span><span class="si">{</span><span class="n">unit_num</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2"> (CSV file): &quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">file_path</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.csv&quot;</span><span class="p">):</span>
                    <span class="n">board_paths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
                    <span class="k">break</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">()</span> <span class="c1"># Retained for separation</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Invalid input. Please enter a file path that ends with &#39;.csv&#39;.&quot;</span><span class="p">)</span>
                    <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">()</span> <span class="c1"># Retained for separation</span>
        <span class="n">board_file_paths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">board_paths</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">()</span>  <span class="c1"># Necessary for spacing</span>

    <span class="n">rb_file_paths</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">unit_num</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_units</span><span class="p">):</span>  <span class="c1"># Range starts from 0</span>
        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">file_path</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Enter the file path for RB U</span><span class="si">{</span><span class="n">unit_num</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2"> (CSV file): &quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">file_path</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">endswith</span> <span class="p">(</span><span class="s2">&quot;.csv&quot;</span><span class="p">):</span>
                <span class="n">rb_file_paths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
                <span class="k">break</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">()</span> <span class="c1"># Retained for separation</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Invalid input. Please enter a file path that ends with &#39;.csv&#39;.&quot;</span><span class="p">)</span>
                <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>

    <span class="nb">print</span><span class="p">()</span>  <span class="c1"># Necessary for spacing</span>

    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">limit_file</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Enter the file path for the limit file (CSV file): &quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">limit_file</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.csv&quot;</span><span class="p">):</span>
            <span class="k">break</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">()</span> <span class="c1"># Retained for separation</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Invalid input. Please enter a file path that ends with &#39;.csv&#39;.&quot;</span><span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>

    <span class="c1"># Review and change file paths</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">clear_console</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Current file paths:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">board_paths</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">board_file_paths</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">path</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">board_paths</span><span class="p">):</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;NB</span><span class="si">{</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="si">}</span><span class="s2"> U</span><span class="si">{</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">path</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">rb_file_paths</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;RB U</span><span class="si">{</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Limit file: </span><span class="si">{</span><span class="n">limit_file</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="n">change</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Are you satisfied with current file paths? (yes/no): &quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">change</span> <span class="o">==</span> <span class="s1">&#39;yes&#39;</span><span class="p">:</span>
            <span class="k">break</span>
        <span class="k">elif</span> <span class="n">change</span> <span class="o">==</span> <span class="s1">&#39;no&#39;</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">()</span> <span class="c1"># Retained for separation</span>
            <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
                <span class="n">path_type</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Which path do you want to change? (NB/RB/Limit): &quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">path_type</span> <span class="o">==</span> <span class="s1">&#39;nb&#39;</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">()</span> <span class="c1"># Retained for separation</span>
                    <span class="c1"># Validate board number</span>
                    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
                        <span class="k">try</span><span class="p">:</span>
                            <span class="n">board_index</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">input</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Enter the new board number (1 to </span><span class="si">{</span><span class="n">num_boards</span><span class="si">}</span><span class="s2">): &quot;</span><span class="p">))</span> <span class="o">-</span> <span class="mi">1</span>
                            <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">board_index</span> <span class="o">&lt;</span> <span class="n">num_boards</span><span class="p">:</span>
                                <span class="k">break</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="nb">print</span><span class="p">()</span> <span class="c1"># Retained for separation</span>
                                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Input out of range! Please enter a valid board number.&quot;</span><span class="p">)</span>
                                <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
                        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                            <span class="nb">print</span><span class="p">()</span> <span class="c1"># Retained for separation</span>
                            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Invalid input. Please enter a number.&quot;</span><span class="p">)</span>
                            <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>

                    <span class="nb">print</span><span class="p">()</span> <span class="c1"># Retained for separation</span>
                    <span class="c1"># Validate unit number</span>
                    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
                        <span class="k">try</span><span class="p">:</span>
                            <span class="n">unit_index</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">input</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Enter the unit number (1 to </span><span class="si">{</span><span class="n">num_units</span><span class="si">}</span><span class="s2">): &quot;</span><span class="p">))</span> <span class="o">-</span> <span class="mi">1</span>
                            <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">unit_index</span> <span class="o">&lt;</span> <span class="n">num_units</span><span class="p">:</span>
                                <span class="k">break</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="nb">print</span><span class="p">()</span> <span class="c1"># Retained for separation</span>
                                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Input out of range! Please enter a valid unit number.&quot;</span><span class="p">)</span>
                                <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
                        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                            <span class="nb">print</span><span class="p">()</span> <span class="c1"># Retained for separation</span>
                            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Invalid input. Please enter a number.&quot;</span><span class="p">)</span>
                            <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>

                    <span class="nb">print</span><span class="p">()</span> <span class="c1"># Retained for separation</span>
                    <span class="c1"># Get new file path</span>
                    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
                        <span class="n">new_path</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Enter the new file path for NB</span><span class="si">{</span><span class="n">board_index</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2"> U</span><span class="si">{</span><span class="n">unit_index</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2"> (CSV file): &quot;</span><span class="p">)</span>
                        <span class="k">if</span> <span class="n">new_path</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.csv&quot;</span><span class="p">):</span>
                            <span class="n">board_file_paths</span><span class="p">[</span><span class="n">board_index</span><span class="p">][</span><span class="n">unit_index</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_path</span>
                            <span class="k">break</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="nb">print</span><span class="p">()</span> <span class="c1"># Retained for separation</span>
                            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Invalid path. It must end with &#39;.csv&#39;.&quot;</span><span class="p">)</span>
                            <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>

                <span class="k">elif</span> <span class="n">path_type</span> <span class="o">==</span> <span class="s1">&#39;rb&#39;</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">()</span> <span class="c1"># Retained for separation</span>
                    <span class="c1"># Validate unit number for RB</span>
                    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
                        <span class="k">try</span><span class="p">:</span>
                            <span class="n">unit_index</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">input</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Enter the unit number (1 to </span><span class="si">{</span><span class="n">num_units</span><span class="si">}</span><span class="s2">): &quot;</span><span class="p">))</span> <span class="o">-</span> <span class="mi">1</span>
                            <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">unit_index</span> <span class="o">&lt;</span> <span class="n">num_units</span><span class="p">:</span>
                                <span class="k">break</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="nb">print</span><span class="p">()</span> <span class="c1"># Retained for separation</span>
                                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Input out of range! Please enter a valid unit number.&quot;</span><span class="p">)</span>
                                <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
                        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                            <span class="nb">print</span><span class="p">()</span>
                            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Invalid input. Please enter a number.&quot;</span><span class="p">)</span>
                            <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>

                    <span class="nb">print</span><span class="p">()</span> <span class="c1"># Retained for separation</span>
                    <span class="c1"># Get new file path</span>
                    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
                        <span class="n">new_path</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Enter the new file path for RB U</span><span class="si">{</span><span class="n">unit_index</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2"> (CSV file): &quot;</span><span class="p">)</span>
                        <span class="k">if</span> <span class="n">new_path</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.csv&quot;</span><span class="p">):</span>
                            <span class="n">rb_file_paths</span><span class="p">[</span><span class="n">unit_index</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_path</span>
                            <span class="k">break</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="nb">print</span><span class="p">()</span> <span class="c1"># Retained for separation</span>
                            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Invalid path. It must end with &#39;.csv&#39;.&quot;</span><span class="p">)</span>
                            <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>

                <span class="k">elif</span> <span class="n">path_type</span> <span class="o">==</span> <span class="s1">&#39;limit&#39;</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">()</span> <span class="c1"># Retained for separation</span>
                    <span class="c1"># Get new limit file path</span>
                    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
                        <span class="n">new_path</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Enter the new file path for the limit file (CSV file): &quot;</span><span class="p">)</span>
                        <span class="k">if</span> <span class="n">new_path</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.csv&quot;</span><span class="p">):</span>
                            <span class="n">limit_file</span> <span class="o">=</span> <span class="n">new_path</span>
                            <span class="k">break</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="nb">print</span><span class="p">()</span> <span class="c1"># Retained for separation</span>
                            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Invalid path. It must end with &#39;.csv&#39;.&quot;</span><span class="p">)</span>
                            <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Invalid option. Please enter &#39;NB&#39;, &#39;RB&#39;, or &#39;Limit&#39;.&quot;</span><span class="p">)</span>
                    <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>

                <span class="nb">print</span><span class="p">()</span> <span class="c1"># Retained for separation</span>

                <span class="n">done</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Are you done making changes? (yes/no): &quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
                <span class="nb">print</span><span class="p">()</span> <span class="c1"># Retained for separation</span>
                <span class="k">if</span> <span class="n">done</span> <span class="o">==</span> <span class="s1">&#39;yes&#39;</span><span class="p">:</span>
                    <span class="k">break</span>

    <span class="k">return</span> <span class="n">board_file_paths</span><span class="p">,</span> <span class="n">rb_file_paths</span><span class="p">,</span> <span class="n">num_boards</span><span class="p">,</span> <span class="n">num_units</span><span class="p">,</span> <span class="n">limit_file</span>
</pre></div>
</div>
</div>
</section>
<section id="Dataframe-cleanup-process-function">
<h3>Dataframe cleanup process function<a class="headerlink" href="#Dataframe-cleanup-process-function" title="Link to this heading"></a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">process_dataframes</span><span class="p">(</span><span class="n">dataframes</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Process a list of DataFrames with the following steps:</span>
<span class="sd">    - Remove rows with NaN values</span>
<span class="sd">    - Drop the &#39;Test #&#39; column</span>
<span class="sd">    - Set &#39;Description&#39; as the index</span>
<span class="sd">    - Transpose the DataFrame</span>
<span class="sd">    - Remove the &#39;Units&#39; index</span>
<span class="sd">    - Reset the index</span>
<span class="sd">    - Convert all data to float</span>

<span class="sd">    Parameters:</span>
<span class="sd">    - dataframes: List of DataFrames to process</span>

<span class="sd">    Returns:</span>
<span class="sd">    - List of processed DataFrames</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">processed_dataframes</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">df</span> <span class="ow">in</span> <span class="n">dataframes</span><span class="p">:</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">thresh</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># Remove rows with too many NaNs</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;Description&#39;</span><span class="p">)</span>  <span class="c1"># Use &#39;Description&#39; as the index</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># Drop the first column (&#39;Test #&#39;)</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">T</span>  <span class="c1"># Transpose the DataFrame</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s1">&#39;Units&#39;</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>  <span class="c1"># Remove &#39;Units&#39; index if it exists</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># Reset the index</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>  <span class="c1"># Convert all values to float</span>

        <span class="n">processed_dataframes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>  <span class="c1"># Add the processed DataFrame to the list</span>

    <span class="k">return</span> <span class="n">processed_dataframes</span>
</pre></div>
</div>
</div>
</section>
<section id="Mean-shift-calculation-function">
<h3>Mean shift calculation function<a class="headerlink" href="#Mean-shift-calculation-function" title="Link to this heading"></a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">mean_shift</span><span class="p">(</span><span class="n">row</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculate the mean shift percentage based on the provided row data.</span>

<span class="sd">    This function computes the mean shift percentage using the &#39;Delta Mean&#39; value</span>
<span class="sd">    and the specified low and high limits. If either limit is not provided or is</span>
<span class="sd">    NaN, the function returns NaN. If the &#39;Delta Mean&#39; is zero, the function returns 0.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    - row: A pandas Series representing a row of data, which should contain:</span>
<span class="sd">        - &#39;Delta Mean&#39;: The delta mean value.</span>
<span class="sd">        - Column indices 2 and 3 for low and high limits, respectively.</span>

<span class="sd">    Returns:</span>
<span class="sd">    - float: The mean shift percentage rounded to five decimal places, or NaN if limits are invalid.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Attempt to convert limits to float and check for NaN in one go</span>
    <span class="n">low_limit</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">row</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
    <span class="n">high_limit</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">row</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">3</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

    <span class="c1"># Return np.nan if either limit is NaN</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">low_limit</span><span class="p">)</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">high_limit</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

    <span class="c1"># Return 0 if Delta Mean is 0</span>
    <span class="k">if</span> <span class="n">row</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Delta Mean&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">0</span>

    <span class="c1"># Calculate and return the mean shift percentage</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Delta Mean&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="p">(</span><span class="n">high_limit</span> <span class="o">-</span> <span class="n">low_limit</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="Mean-shift-criteria-decision-function">
<h3>Mean shift criteria decision function<a class="headerlink" href="#Mean-shift-criteria-decision-function" title="Link to this heading"></a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">mean_shift_crit</span><span class="p">(</span><span class="n">row</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Evaluate the mean shift criteria based on the provided row data.</span>

<span class="sd">    This function checks the &#39;Mean Shift&#39; and &#39;Delta Mean&#39; values against a specified</span>
<span class="sd">    standard deviation limit. It returns &quot;Passed&quot;, &quot;Failed&quot;, or &quot;For check&quot; based on</span>
<span class="sd">    the evaluation criteria.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    - row: A pandas Series representing a row of data, which should contain:</span>
<span class="sd">        - &#39;Mean Shift&#39;: The mean shift value to evaluate.</span>
<span class="sd">        - &#39;Delta Mean&#39;: The delta mean value.</span>
<span class="sd">        - Column index 4 for the standard deviation limit.</span>

<span class="sd">    Returns:</span>
<span class="sd">    - str: &quot;Passed&quot;, &quot;Failed&quot;, or &quot;For check&quot; based on the evaluation criteria.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">mean_shf</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Mean Shift&#39;</span><span class="p">]</span>
    <span class="n">d_mean</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Delta Mean&#39;</span><span class="p">]</span>
    <span class="n">sdlot</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>

    <span class="c1"># Check the conditions</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">mean_shf</span><span class="p">):</span>  <span class="c1"># Check if mean_shf is NaN</span>
        <span class="k">return</span> <span class="s2">&quot;Passed&quot;</span> <span class="k">if</span> <span class="n">d_mean</span> <span class="o">&lt;=</span> <span class="n">sdlot</span> <span class="k">else</span> <span class="s2">&quot;For check&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;Passed&quot;</span> <span class="k">if</span> <span class="n">mean_shf</span> <span class="o">&lt;=</span> <span class="mi">5</span> <span class="k">else</span> <span class="s2">&quot;Failed&quot;</span>
</pre></div>
</div>
</div>
</section>
<section id="Standard-deviation-ratio-calculation">
<h3>Standard deviation ratio calculation<a class="headerlink" href="#Standard-deviation-ratio-calculation" title="Link to this heading"></a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">sd_ratio</span><span class="p">(</span><span class="n">row</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculate the standard deviation ratio based on the provided row data.</span>

<span class="sd">    This function computes the ratio of two values from the row. If either of the</span>
<span class="sd">    values is zero, the function returns 0. Otherwise, it returns the ratio rounded</span>
<span class="sd">    to six decimal places.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    - row: A pandas Series representing a row of data, which should contain:</span>
<span class="sd">        - Column index 7: The standard deviation for RB at certain unit.</span>
<span class="sd">        - Column index 9: The standard deviation for certain NB at certain unit.</span>

<span class="sd">    Returns:</span>
<span class="sd">    - float: The standard deviation ratio rounded to six decimal places, or 0 if</span>
<span class="sd">      either value is zero.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">0</span>
    <span class="k">elif</span> <span class="n">row</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">0</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span> <span class="o">/</span> <span class="n">row</span><span class="p">[</span><span class="mi">7</span><span class="p">],</span> <span class="mi">6</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="Standard-deviation-criteria-decision-function">
<h3>Standard deviation criteria decision function<a class="headerlink" href="#Standard-deviation-criteria-decision-function" title="Link to this heading"></a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">sd_ratio_crit</span><span class="p">(</span><span class="n">row</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Evaluate the standard deviation ratio criteria based on the provided row data.</span>

<span class="sd">    This function checks the &#39;SD Ratio&#39; value against a threshold of 1.5.</span>
<span class="sd">    It returns &quot;Passed&quot; if the ratio is less than or equal to 1.5,</span>
<span class="sd">    and &quot;For check&quot; otherwise.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    - row: A pandas Series representing a row of data, which should contain:</span>
<span class="sd">        - &#39;SD Ratio&#39;: The standard deviation ratio to evaluate.</span>

<span class="sd">    Returns:</span>
<span class="sd">    - str: &quot;Passed&quot; if the SD Ratio is less than or equal to 1.5,</span>
<span class="sd">           or &quot;For check&quot; if it exceeds 1.5.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;SD Ratio&quot;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mf">1.5</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;Passed&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;For check&quot;</span>
</pre></div>
</div>
</div>
</section>
<section id="Evaluation-status-function">
<h3>Evaluation status function<a class="headerlink" href="#Evaluation-status-function" title="Link to this heading"></a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">eva_status</span><span class="p">(</span><span class="n">row</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Evaluate the overall status based on mean shift and standard deviation ratio criteria.</span>

<span class="sd">    This function checks the evaluation status of &#39;Mean Shift Criteria&#39; and</span>
<span class="sd">    &#39;SD Ratio Criteria&#39;. It returns &quot;Passed&quot; if both criteria are passed,</span>
<span class="sd">    &quot;Failed&quot; if the mean shift criteria has failed, and &quot;For check&quot;</span>
<span class="sd">    for any other combination of statuses.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    - row: A pandas Series representing a row of data, which should contain:</span>
<span class="sd">        - &#39;Mean Shift Criteria&#39;: The evaluation result of the mean shift.</span>
<span class="sd">        - &#39;SD Ratio Criteria&#39;: The evaluation result of the standard deviation ratio.</span>

<span class="sd">    Returns:</span>
<span class="sd">    - str: &quot;Passed&quot; if both criteria are passed,</span>
<span class="sd">           &quot;Failed&quot; if the mean shift criteria has failed,</span>
<span class="sd">           or &quot;For check&quot; for any other combination.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Mean Shift Criteria&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Passed&quot;</span> <span class="ow">and</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SD Ratio Criteria&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Passed&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;Passed&quot;</span>
    <span class="k">elif</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Mean Shift Criteria&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Failed&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;Failed&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;For check&quot;</span>
</pre></div>
</div>
</div>
</section>
<section id="Cp-Calculation-for-RB">
<h3>Cp Calculation for RB<a class="headerlink" href="#Cp-Calculation-for-RB" title="Link to this heading"></a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">calculate_cp_rb</span><span class="p">(</span><span class="n">row</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculate the Cp and RB value based on the provided row data.</span>

<span class="sd">    This function computes the Cp and Rb value using the formula:</span>
<span class="sd">    (row[3] - row[2]) / (6 * row[7]). It checks for specific conditions</span>
<span class="sd">    before performing the calculation, returning NaN if any of the</span>
<span class="sd">    required values are zero or missing.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    - row: A pandas Series representing a row of data, which should contain:</span>
<span class="sd">        - row[2]: The lower specification limit.</span>
<span class="sd">        - row[3]: The upper specification limit.</span>
<span class="sd">        - row[7]: The standard deviation for RB</span>

<span class="sd">    Returns:</span>
<span class="sd">    - float: The calculated Cp and RB value rounded to two decimal places,</span>
<span class="sd">             or NaN if any of the required values are zero or missing.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Check if row[7] is 0</span>
    <span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

    <span class="c1"># Check for empty or &quot;NA&quot; values</span>
    <span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="ow">is</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span> <span class="ow">or</span> <span class="n">row</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="ow">is</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span> <span class="ow">or</span> <span class="n">row</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="ow">is</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

    <span class="c1"># Perform the calculation</span>
    <span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">-</span> <span class="n">row</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="mi">6</span> <span class="o">*</span> <span class="n">row</span><span class="p">[</span><span class="mi">7</span><span class="p">])</span>

    <span class="c1"># Round the result to 2 decimal places</span>
    <span class="k">return</span> <span class="nb">round</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="Cpk-Calculation-for-RB">
<h3>Cpk Calculation for RB<a class="headerlink" href="#Cpk-Calculation-for-RB" title="Link to this heading"></a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">calculate_cpk_rb</span><span class="p">(</span><span class="n">row</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculate the CpK and RB value based on the provided row data.</span>

<span class="sd">    This function computes the CpK value using the available specification limits</span>
<span class="sd">    and standard deviation. It checks for NaN values and ensures that the standard</span>
<span class="sd">    deviation is not zero before performing the calculation. The function returns</span>
<span class="sd">    the CpK value rounded to two decimal places along with a decision message</span>
<span class="sd">    indicating the capability status.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    - row: A pandas Series representing a row of data, which should contain:</span>
<span class="sd">        - row[2]: The lower specification limit.</span>
<span class="sd">        - row[3]: The upper specification limit.</span>
<span class="sd">        - row[6]: The mean for RB at certain unit.</span>
<span class="sd">        - row[7]: The standard deviation for RB</span>

<span class="sd">    Returns:</span>
<span class="sd">    - tuple: A tuple containing:</span>
<span class="sd">        - float: The calculated CpK value rounded to two decimal places,</span>
<span class="sd">                 or NaN if the required values are missing or invalid.</span>
<span class="sd">        - str: A decision message indicating the capability status (&quot;Not capable&quot;</span>
<span class="sd">               or &quot;Good capable&quot;).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Check for NaN values and if row[7] is 0</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span> <span class="ow">or</span> <span class="n">row</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="s2">&quot;N/A&quot;</span>

    <span class="c1"># Calculate cpk based on the available values</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="mi">2</span><span class="p">]):</span>
        <span class="n">cpk</span> <span class="o">=</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">-</span> <span class="n">row</span><span class="p">[</span><span class="mi">6</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="mi">3</span> <span class="o">*</span> <span class="n">row</span><span class="p">[</span><span class="mi">7</span><span class="p">])</span>
    <span class="k">elif</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="mi">3</span><span class="p">]):</span>
        <span class="n">cpk</span> <span class="o">=</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">-</span> <span class="n">row</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="mi">3</span> <span class="o">*</span> <span class="n">row</span><span class="p">[</span><span class="mi">7</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">cpk</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">-</span> <span class="n">row</span><span class="p">[</span><span class="mi">6</span><span class="p">],</span> <span class="n">row</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">-</span> <span class="n">row</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="mi">3</span> <span class="o">*</span> <span class="n">row</span><span class="p">[</span><span class="mi">7</span><span class="p">])</span>

    <span class="c1"># Round cpk to 2 decimal places</span>
    <span class="n">cpk</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">cpk</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

    <span class="c1"># Concise decision statements</span>
    <span class="k">if</span> <span class="n">cpk</span> <span class="o">&lt;</span> <span class="mf">1.3</span><span class="p">:</span>
        <span class="n">decision_message</span> <span class="o">=</span> <span class="s2">&quot;Not capable&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">decision_message</span> <span class="o">=</span> <span class="s2">&quot;Good capable&quot;</span>

    <span class="k">return</span> <span class="n">cpk</span><span class="p">,</span> <span class="n">decision_message</span>
</pre></div>
</div>
</div>
</section>
<section id="Cp-Calculation-for-NB">
<h3>Cp Calculation for NB<a class="headerlink" href="#Cp-Calculation-for-NB" title="Link to this heading"></a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">calculate_cp_nb</span><span class="p">(</span><span class="n">row</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculate the Cp value based on the provided row data.</span>

<span class="sd">    This function computes the Cp value using the formula:</span>
<span class="sd">    (row[3] - row[2]) / (6 * row[12]). It checks for specific conditions</span>
<span class="sd">    before performing the calculation, returning NaN if any of the</span>
<span class="sd">    required values are zero or missing.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    - row: A pandas Series representing a row of data, which should contain:</span>
<span class="sd">        - row[2]: The lower specification limit.</span>
<span class="sd">        - row[3]: The upper specification limit.</span>
<span class="sd">        - row[12]: The standard deviation for certain NB</span>

<span class="sd">    Returns:</span>
<span class="sd">    - float: The calculated Cp value rounded to two decimal places,</span>
<span class="sd">             or NaN if any of the required values are zero or missing.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Check if row[12] is 0</span>
    <span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

    <span class="c1"># Check for empty or &quot;NA&quot; values</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="mi">12</span><span class="p">]):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

    <span class="c1"># Perform the calculation</span>
    <span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">-</span> <span class="n">row</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="mi">6</span> <span class="o">*</span> <span class="n">row</span><span class="p">[</span><span class="mi">12</span><span class="p">])</span>

    <span class="c1"># Round the result to 2 decimal places</span>
    <span class="k">return</span> <span class="nb">round</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="Cpk-Calculation-for-NB">
<h3>Cpk Calculation for NB<a class="headerlink" href="#Cpk-Calculation-for-NB" title="Link to this heading"></a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">calculate_cpk_nb</span><span class="p">(</span><span class="n">row</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculate the CpK value based on the provided row data.</span>

<span class="sd">    This function computes the CpK value using the available specification limits</span>
<span class="sd">    and standard deviation. It checks for NaN values and ensures that the standard</span>
<span class="sd">    deviation is not zero before performing the calculation. The function returns</span>
<span class="sd">    the CpK value rounded to two decimal places along with a decision message</span>
<span class="sd">    indicating the capability status.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    - row: A pandas Series representing a row of data, which should contain:</span>
<span class="sd">        - row[2]: The lower specification limit.</span>
<span class="sd">        - row[3]: The upper specification limit.</span>
<span class="sd">        - row[11]: The mean for certain NB.</span>
<span class="sd">        - row[12]: The standard deviation for ceratin NB.</span>

<span class="sd">    Returns:</span>
<span class="sd">    - tuple: A tuple containing:</span>
<span class="sd">        - float: The calculated CpK value rounded to two decimal places,</span>
<span class="sd">                 or NaN if the required values are missing or invalid.</span>
<span class="sd">        - str: A decision message indicating the capability status (&quot;Not capable&quot;</span>
<span class="sd">               or &quot;Good capable&quot;).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Check for NaN values and if row[12] is 0</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span> <span class="ow">or</span> <span class="n">row</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="s2">&quot;N/A&quot;</span>

    <span class="c1"># Calculate cpk based on the available values</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="mi">2</span><span class="p">]):</span>
        <span class="n">cpk</span> <span class="o">=</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">-</span> <span class="n">row</span><span class="p">[</span><span class="mi">11</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="mi">3</span> <span class="o">*</span> <span class="n">row</span><span class="p">[</span><span class="mi">12</span><span class="p">])</span>
    <span class="k">elif</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="mi">3</span><span class="p">]):</span>
        <span class="n">cpk</span> <span class="o">=</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span> <span class="o">-</span> <span class="n">row</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="mi">3</span> <span class="o">*</span> <span class="n">row</span><span class="p">[</span><span class="mi">12</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">cpk</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">-</span> <span class="n">row</span><span class="p">[</span><span class="mi">11</span><span class="p">],</span> <span class="n">row</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span> <span class="o">-</span> <span class="n">row</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="mi">3</span> <span class="o">*</span> <span class="n">row</span><span class="p">[</span><span class="mi">12</span><span class="p">])</span>

    <span class="c1"># Round cpk to 2 decimal places</span>
    <span class="n">cpk</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">cpk</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

    <span class="c1"># Concise decision statements</span>
    <span class="k">if</span> <span class="n">cpk</span> <span class="o">&lt;</span> <span class="mf">1.3</span><span class="p">:</span>
        <span class="n">decision_message</span> <span class="o">=</span> <span class="s2">&quot;Not capable&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">decision_message</span> <span class="o">=</span> <span class="s2">&quot;Good capable&quot;</span>

    <span class="k">return</span> <span class="n">cpk</span><span class="p">,</span> <span class="n">decision_message</span>
</pre></div>
</div>
</div>
</section>
<section id="Check-value-based-on-number-of-failure-test-function">
<h3>Check value based on number of failure test function<a class="headerlink" href="#Check-value-based-on-number-of-failure-test-function" title="Link to this heading"></a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">check_value</span><span class="p">(</span><span class="n">col</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Check the value in the specified column and return a corresponding message.</span>

<span class="sd">    This function evaluates the value in the fourth element of the provided</span>
<span class="sd">    column (index 3) which is Failed test all units and returns a message based on its content.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    - col: A list or array-like structure where the fourth element (index 3)</span>
<span class="sd">           is evaluated in this &quot;Failed test all units&quot; column.</span>

<span class="sd">    Returns:</span>
<span class="sd">    - str: A message indicating the status based on the value:</span>
<span class="sd">        - An empty string if the value is an empty string.</span>
<span class="sd">        - &quot;Good to release if no concern&quot; if the value is 0.</span>
<span class="sd">        - &quot;Not acceptable&quot; for any other value.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">col</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;&quot;</span>
    <span class="k">elif</span> <span class="n">col</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;Good to release if no concern&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;Not acceptable&quot;</span>
</pre></div>
</div>
</div>
</section>
<section id="Autofit-column-for-generate-report">
<h3>Autofit column for generate report<a class="headerlink" href="#Autofit-column-for-generate-report" title="Link to this heading"></a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">autosize_columns</span><span class="p">(</span><span class="n">worksheet</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Auto-adjust the width of columns in the given worksheet.</span>

<span class="sd">    This function iterates through all rows in the specified worksheet and calculates</span>
<span class="sd">    the maximum length of the content in each column. It then sets the width of each</span>
<span class="sd">    column based on the calculated maximum lengths, adding a small padding for better</span>
<span class="sd">    visibility.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    - worksheet: An instance of an openpyxl worksheet where the column widths</span>
<span class="sd">                  need to be adjusted.</span>

<span class="sd">    Returns:</span>
<span class="sd">    - None: This function modifies the worksheet in place and does not return a value.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">column_widths</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># Iterate through all rows in the worksheet</span>
    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">worksheet</span><span class="o">.</span><span class="n">iter_rows</span><span class="p">(</span><span class="n">values_only</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">cell</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">row</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">cell</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">cell_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">cell</span><span class="p">))</span>  <span class="c1"># Get the length of the cell content</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">column_widths</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">i</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">cell_length</span> <span class="o">&gt;</span> <span class="n">column_widths</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
                        <span class="n">column_widths</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">cell_length</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">column_widths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cell_length</span><span class="p">)</span>

    <span class="c1"># Set the width of each column based on the calculated maximum lengths</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">column_width</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">column_widths</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>  <span class="c1"># Start at 1 for column indexing</span>
        <span class="n">worksheet</span><span class="o">.</span><span class="n">column_dimensions</span><span class="p">[</span><span class="n">get_column_letter</span><span class="p">(</span><span class="n">i</span><span class="p">)]</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="n">column_width</span> <span class="o">+</span> <span class="mf">0.5</span>  <span class="c1"># Adding padding</span>
</pre></div>
</div>
</div>
</section>
</section>
<section id="Display-Banner-&amp;-Asking-Input">
<h2>Display Banner &amp; Asking Input<a class="headerlink" href="#Display-Banner-&-Asking-Input" title="Link to this heading"></a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Display the banner to the user</span>
<span class="n">display_banner</span><span class="p">()</span>

<span class="c1"># Retrieve product information</span>
<span class="n">product_info</span> <span class="o">=</span> <span class="n">get_product_information</span><span class="p">()</span>

<span class="c1"># Retrieve setup information</span>
<span class="n">setup_info</span> <span class="o">=</span> <span class="n">get_setup_information</span><span class="p">()</span>

<span class="c1"># Obtain data related to files, number of boards, number of units, and limits</span>
<span class="n">nb_file</span><span class="p">,</span> <span class="n">rb_file</span><span class="p">,</span> <span class="n">num_boards</span><span class="p">,</span> <span class="n">num_units</span><span class="p">,</span> <span class="n">limit</span> <span class="o">=</span> <span class="n">get_data</span><span class="p">()</span>
</pre></div>
</div>
</div>
</section>
<section id="Data-Processing">
<h2>Data Processing<a class="headerlink" href="#Data-Processing" title="Link to this heading"></a></h2>
<section id="Read-and-Data-processing-for-Limit-file">
<h3>Read and Data processing for Limit file<a class="headerlink" href="#Read-and-Data-processing-for-Limit-file" title="Link to this heading"></a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Read the CSV file into a DataFrame</span>
<span class="n">limit</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">limit</span><span class="p">)</span>

<span class="c1"># Reset the index of the DataFrame, dropping the old index</span>
<span class="n">limit</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Convert the &#39;Test #&#39; column to strings and remove &#39;\t&#39;</span>
<span class="n">limit</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">limit</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;\t&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Remove rows with too many NaNs</span>
<span class="n">limit</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">thresh</span><span class="o">=</span><span class="n">limit</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">3</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Fill any NaN values with numpy&#39;s NaN</span>
<span class="n">limit</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Convert the values in the third column to float</span>
<span class="n">limit</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">limit</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;float&#39;</span><span class="p">)</span>

<span class="c1"># Convert the values in the fourth column to float</span>
<span class="n">limit</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">limit</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;float&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="Read-RB-for-all-units">
<h3>Read RB for all units<a class="headerlink" href="#Read-RB-for-all-units" title="Link to this heading"></a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Initialize an empty list to hold the DataFrames</span>
<span class="n">rb</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># Loop through the unit numbers</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_units</span><span class="p">):</span>
    <span class="c1"># Construct the filename based on the unit number</span>
    <span class="n">file_path</span> <span class="o">=</span> <span class="n">rb_file</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

    <span class="c1"># Read the CSV file and append the DataFrame to the list</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>  <span class="c1"># Read the CSV file into a DataFrame</span>
        <span class="n">rb</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>  <span class="c1"># Append the DataFrame to the list</span>
    <span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;File not found: </span><span class="si">{</span><span class="n">file_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># Handle the case where the file is not found</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;An error occurred while reading </span><span class="si">{</span><span class="n">file_path</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># Handle any other exceptions</span>
</pre></div>
</div>
</div>
</section>
<section id="Read-all-NB-for-all-units">
<h3>Read all NB for all units<a class="headerlink" href="#Read-all-NB-for-all-units" title="Link to this heading"></a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Initialize an empty list to hold the DataFrames for each board</span>
<span class="n">nb</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># Loop to get input paths for each board and its units</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_boards</span><span class="p">):</span>
    <span class="n">board_units</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># Initialize a list to hold the DataFrames for the current board</span>

    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_units</span><span class="p">):</span>
        <span class="c1"># Construct the input path based on board and unit numbers</span>
        <span class="n">file_path</span> <span class="o">=</span> <span class="n">nb_file</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span>

        <span class="c1"># Read the DataFrame from the constructed input path</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>  <span class="c1"># Read the CSV file into a DataFrame</span>
            <span class="n">board_units</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>  <span class="c1"># Append the DataFrame for the current unit</span>

        <span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;File not found: </span><span class="si">{</span><span class="n">file_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># Handle the case where the file is not found</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;An error occurred while reading </span><span class="si">{</span><span class="n">file_path</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># Handle any other exceptions</span>

    <span class="c1"># Append the current board&#39;s units to the main list</span>
    <span class="n">nb</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">board_units</span><span class="p">)</span>  <span class="c1"># Add the list of DataFrames for the current board to the main list</span>
</pre></div>
</div>
</div>
</section>
<section id="Data-processing-for-all-NBs-and-RB-for-all-units">
<h3>Data processing for all NBs and RB for all units<a class="headerlink" href="#Data-processing-for-all-NBs-and-RB-for-all-units" title="Link to this heading"></a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Process the list of DataFrames for the &#39;rb&#39; variable</span>
<span class="n">rb_mod</span> <span class="o">=</span> <span class="n">process_dataframes</span><span class="p">(</span><span class="n">rb</span><span class="p">)</span>

<span class="c1"># Initialize an empty list to hold processed DataFrames for each board</span>
<span class="n">nb_mod</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># Loop through each board in the &#39;nb&#39; list</span>
<span class="k">for</span> <span class="n">board</span> <span class="ow">in</span> <span class="n">nb</span><span class="p">:</span>
    <span class="c1"># Process the DataFrames for the current board</span>
    <span class="n">processed_units</span> <span class="o">=</span> <span class="n">process_dataframes</span><span class="p">(</span><span class="n">board</span><span class="p">)</span>

    <span class="c1"># Append processed DataFrames for each board to the main list</span>
    <span class="n">nb_mod</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">processed_units</span><span class="p">)</span>  <span class="c1"># Add the processed units for the current board</span>
</pre></div>
</div>
</div>
</section>
</section>
<section id="Correlation-Report">
<h2>Correlation Report<a class="headerlink" href="#Correlation-Report" title="Link to this heading"></a></h2>
<section id="Calculate-mean-and-standard-deviation-for-RB-for-all-units">
<h3>Calculate mean and standard deviation for RB for all units<a class="headerlink" href="#Calculate-mean-and-standard-deviation-for-RB-for-all-units" title="Link to this heading"></a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Initialize empty lists to hold the mean and standard deviation DataFrames</span>
<span class="n">mean_rb</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">std_rb</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># Loop through each modified DataFrame in the &#39;rb_mod&#39; list</span>
<span class="k">for</span> <span class="n">df_mod</span> <span class="ow">in</span> <span class="n">rb_mod</span><span class="p">:</span>
    <span class="c1"># Calculate the mean for each column and format it to six decimal places</span>
    <span class="n">mean</span> <span class="o">=</span> <span class="n">df_mod</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">x</span><span class="si">:</span><span class="s1">.6f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>

    <span class="c1"># Calculate the standard deviation for each column (using population standard deviation) and format it to five decimal places</span>
    <span class="n">std</span> <span class="o">=</span> <span class="n">df_mod</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">ddof</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">x</span><span class="si">:</span><span class="s1">.5f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>

    <span class="c1"># Append the mean and standard deviation to their respective lists</span>
    <span class="n">mean_rb</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mean</span><span class="p">)</span>
    <span class="n">std_rb</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">std</span><span class="p">)</span>

<span class="c1"># Reset the index of each mean DataFrame to create a clean list of DataFrames</span>
<span class="n">mean_rb_clean</span> <span class="o">=</span> <span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">for</span> <span class="n">df</span> <span class="ow">in</span> <span class="n">mean_rb</span><span class="p">]</span>

<span class="c1"># Reset the index of each standard deviation DataFrame to create a clean list of DataFrames</span>
<span class="n">std_rb_clean</span> <span class="o">=</span> <span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">for</span> <span class="n">df</span> <span class="ow">in</span> <span class="n">std_rb</span><span class="p">]</span>

<span class="c1"># Create a list of column names for the mean DataFrames</span>
<span class="n">columns_mean_rb</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;Mean RB U</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_units</span><span class="p">)]</span>

<span class="c1"># Create a list of column names for the standard deviation DataFrames</span>
<span class="n">columns_std_rb</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;SD RB U</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_units</span><span class="p">)]</span>

<span class="c1"># Initialize empty DataFrames to hold the real mean and standard deviation values</span>
<span class="n">realrbmean</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="n">realrbstd</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>

<span class="c1"># Loop through each column name and corresponding mean value</span>
<span class="k">for</span> <span class="n">col</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">columns_mean_rb</span><span class="p">,</span> <span class="n">mean_rb_clean</span><span class="p">):</span>
    <span class="n">realrbmean</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span>  <span class="c1"># Assign the mean values to the corresponding column in the DataFrame</span>

<span class="c1"># Loop through each column name and corresponding standard deviation value</span>
<span class="k">for</span> <span class="n">col</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">columns_std_rb</span><span class="p">,</span> <span class="n">std_rb_clean</span><span class="p">):</span>
    <span class="n">realrbstd</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span>  <span class="c1"># Assign the standard deviation values to the corresponding column in the DataFrame</span>
</pre></div>
</div>
</div>
</section>
<section id="Calculate-mean-and-standard-deviation-for-all-NBs-for-all-units">
<h3>Calculate mean and standard deviation for all NBs for all units<a class="headerlink" href="#Calculate-mean-and-standard-deviation-for-all-NBs-for-all-units" title="Link to this heading"></a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Assuming nb_mod is a list of lists of NumPy arrays instead of DataFrames</span>
<span class="n">mean_nb_clean</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># Initialize the mean list outside the loop</span>
<span class="n">std_nb_clean</span> <span class="o">=</span> <span class="p">[]</span>   <span class="c1"># Initialize the standard deviation list outside the loop</span>

<span class="c1"># Iterate through each inner list in nb_mod</span>
<span class="k">for</span> <span class="n">inner_list</span> <span class="ow">in</span> <span class="n">nb_mod</span><span class="p">:</span>
    <span class="n">mean_row</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># Temporary list to hold means for the current inner list</span>
    <span class="n">std_row</span> <span class="o">=</span> <span class="p">[]</span>   <span class="c1"># Temporary list to hold standard deviations for the current inner list</span>

    <span class="c1"># Iterate through each NumPy array in the inner list</span>
    <span class="k">for</span> <span class="n">arr_mod</span> <span class="ow">in</span> <span class="n">inner_list</span><span class="p">:</span>
        <span class="c1"># Calculate mean and standard deviation using NumPy</span>
        <span class="n">mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">arr_mod</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># Calculate mean along the specified axis</span>
        <span class="n">std</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">arr_mod</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ddof</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># Calculate standard deviation along the specified axis</span>

        <span class="c1"># Append results to respective temporary lists</span>
        <span class="n">mean_row</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>  <span class="c1"># Round the mean and convert to list</span>
        <span class="n">std_row</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">std</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>    <span class="c1"># Round the standard deviation and convert to list</span>

    <span class="c1"># Append the temporary lists to the main 2D lists</span>
    <span class="n">mean_nb_clean</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mean_row</span><span class="p">)</span>  <span class="c1"># Add the mean row to the main list</span>
    <span class="n">std_nb_clean</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">std_row</span><span class="p">)</span>     <span class="c1"># Add the std row to the main list</span>

<span class="c1"># mean_nb_clean and std_nb_clean are now 2D lists of means and standard deviations</span>

<span class="c1"># Create 2D lists to hold column names for means and standard deviations</span>
<span class="n">columns_mean_nb</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">columns_std_nb</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># Fill the lists with column names for each board</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_boards</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
    <span class="c1"># Generate mean column names for the current board</span>
    <span class="n">mean_columns</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;Mean NB</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s1"> U</span><span class="si">{</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_units</span><span class="p">)]</span>

    <span class="c1"># Generate standard deviation column names for the current board</span>
    <span class="n">std_columns</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;SD NB</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s1"> U</span><span class="si">{</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_units</span><span class="p">)]</span>

    <span class="c1"># Append the mean columns for the current board to the list</span>
    <span class="n">columns_mean_nb</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mean_columns</span><span class="p">)</span>

    <span class="c1"># Append the standard deviation columns for the current board to the list</span>
    <span class="n">columns_std_nb</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">std_columns</span><span class="p">)</span>

<span class="c1"># Create a list to hold the empty DataFrames for means</span>
<span class="n">realnbmean</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># Create a list to hold the empty DataFrames for standard deviations</span>
<span class="n">realnbstd</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># Loop to create empty DataFrames and append them to the realnbmean list</span>
<span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_boards</span><span class="p">):</span>
    <span class="n">realnbmean</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">())</span>  <span class="c1"># Append an empty DataFrame for each board</span>

<span class="c1"># Loop to create empty DataFrames and append them to the realnbstd list</span>
<span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_boards</span><span class="p">):</span>
    <span class="n">realnbstd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">())</span>  <span class="c1"># Append an empty DataFrame for each board</span>

<span class="c1"># Populate the realnbmean DataFrames with mean values</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_boards</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">col</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">columns_mean_nb</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">mean_nb_clean</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span>
        <span class="n">realnbmean</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span>  <span class="c1"># Assign mean values to the corresponding columns</span>

<span class="c1"># Populate the realnbstd DataFrames with standard deviation values</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_boards</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">col</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">columns_std_nb</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">std_nb_clean</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span>
        <span class="n">realnbstd</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span>  <span class="c1"># Assign standard deviation values to the corresponding columns</span>
</pre></div>
</div>
</div>
</section>
<section id="Create-dataframe-for-limit-and-RB-for-all-units">
<h3>Create dataframe for limit and RB for all units<a class="headerlink" href="#Create-dataframe-for-limit-and-RB-for-all-units" title="Link to this heading"></a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Initialize a list to hold the calculated limits for each unit</span>
<span class="n">rb_lim_calc</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># i = unit</span>

<span class="c1"># Loop through each unit to calculate limits</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_units</span><span class="p">):</span>
    <span class="c1"># Concatenate the limit DataFrame with the mean and standard deviation for the current unit</span>
    <span class="n">temp</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">limit</span><span class="p">,</span> <span class="n">realrbmean</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">i</span><span class="p">],</span> <span class="n">realrbstd</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1"># Append the concatenated DataFrame to the rb_lim_calc list</span>
    <span class="n">rb_lim_calc</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="Create-and-Analyzing-DataFrames-all-NBS-for-all-Units">
<h3>Create and Analyzing DataFrames all NBS for all Units<a class="headerlink" href="#Create-and-Analyzing-DataFrames-all-NBS-for-all-Units" title="Link to this heading"></a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a 2D list to hold the concatenated DataFrames for each board and unit</span>
<span class="n">rb_nbu</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># Loop through the boards to create the 2D list</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_boards</span><span class="p">):</span>
    <span class="n">temp_list</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># Temporary list to hold DataFrames for the current board</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_units</span><span class="p">):</span>
        <span class="c1"># Concatenate the DataFrames for the current unit, including limits, means, and standard deviations</span>
        <span class="n">temp</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">rb_lim_calc</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">realnbmean</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">j</span><span class="p">],</span> <span class="n">realnbstd</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">j</span><span class="p">]],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="c1"># Append the concatenated DataFrame to the temporary list</span>
        <span class="n">temp_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>

    <span class="c1"># Append the temporary list of DataFrames for the current board to the main 2D list</span>
    <span class="n">rb_nbu</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">temp_list</span><span class="p">)</span>

<span class="c1"># Loop through each board</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_boards</span><span class="p">):</span>
    <span class="c1"># Loop through each unit within the current board</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_units</span><span class="p">):</span>
        <span class="c1"># Calculate the absolute difference between two columns and round it to 6 decimal places</span>
        <span class="n">rb_nbu</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="s1">&#39;Delta Mean&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rb_nbu</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="o">-</span> <span class="n">row</span><span class="p">[</span><span class="mi">6</span><span class="p">]),</span> <span class="mi">6</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="c1"># Apply the mean_shift function to calculate the mean shift for each row</span>
        <span class="n">rb_nbu</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="s1">&#39;Mean Shift&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rb_nbu</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">mean_shift</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="c1"># Apply the mean_shift_crit function to evaluate the mean shift criteria for each row</span>
        <span class="n">rb_nbu</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="s1">&#39;Mean Shift Criteria&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rb_nbu</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">mean_shift_crit</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="c1"># Apply the sd_ratio function to calculate the standard deviation ratio for each row</span>
        <span class="n">rb_nbu</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="s1">&#39;SD Ratio&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rb_nbu</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">sd_ratio</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="c1"># Apply the sd_ratio_crit function to evaluate the standard deviation ratio criteria for each row</span>
        <span class="n">rb_nbu</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="s1">&#39;SD Ratio Criteria&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rb_nbu</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">sd_ratio_crit</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="c1"># Apply the eva_status function to determine the result for each unit based on the evaluations</span>
        <span class="n">rb_nbu</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="s1">&#39;Result Unit&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rb_nbu</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">eva_status</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="Store-all-NBs-based-on-Unit-Results-and-Overall-NBs-Status">
<h3>Store all NBs based on Unit Results and Overall NBs Status<a class="headerlink" href="#Store-all-NBs-based-on-Unit-Results-and-Overall-NBs-Status" title="Link to this heading"></a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create an empty list to hold the DataFrames for each board</span>
<span class="n">nb_results</span> <span class="o">=</span> <span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_boards</span><span class="p">)]</span>

<span class="c1"># Loop through each board to populate the results</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_boards</span><span class="p">):</span>
    <span class="c1"># Create a new column for each unit&#39;s result within the current board</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_units</span><span class="p">):</span>
        <span class="c1"># Assign the &#39;Result Unit&#39; data from rb_nbu to the new DataFrame for the current board and unit</span>
        <span class="n">nb_results</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="sa">f</span><span class="s1">&#39;Result NB</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s1"> U</span><span class="si">{</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rb_nbu</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="s1">&#39;Result Unit&#39;</span><span class="p">]</span>

    <span class="c1"># Check if all results for the board are &quot;Passed&quot; and create a new column for the overall result</span>
    <span class="n">all_passed</span> <span class="o">=</span> <span class="n">nb_results</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">eq</span><span class="p">(</span><span class="s2">&quot;Passed&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1"># Assign the overall result based on whether all units passed or not</span>
    <span class="n">nb_results</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="sa">f</span><span class="s2">&quot;NB</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2"> Result&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">all_passed</span><span class="o">.</span><span class="n">replace</span><span class="p">({</span><span class="kc">True</span><span class="p">:</span> <span class="s1">&#39;Passed&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">:</span> <span class="s1">&#39;For check&#39;</span><span class="p">})</span>
</pre></div>
</div>
</div>
</section>
<section id="Combine-Limits-with-all-NBs-Results">
<h3>Combine Limits with all NBs Results<a class="headerlink" href="#Combine-Limits-with-all-NBs-Results" title="Link to this heading"></a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Initialize an empty list to hold the concatenated results</span>
<span class="n">nbtrueresult</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># Loop through each board to concatenate the limit with the results</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_boards</span><span class="p">):</span>
    <span class="c1"># Concatenate the limit DataFrame/Series with the results DataFrame for the current board</span>
    <span class="n">temp</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">limit</span><span class="p">,</span> <span class="n">nb_results</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># Wrap the arguments in a list</span>

    <span class="c1"># Append the concatenated DataFrame to the nbtrueresult list</span>
    <span class="n">nbtrueresult</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
</section>
<section id="Cpk-Report">
<h2>Cpk Report<a class="headerlink" href="#Cpk-Report" title="Link to this heading"></a></h2>
<section id="Combine-Unit-Results-for-RB-and-all-NBs-into-a-Single-DataFrame-respectively">
<h3>Combine Unit Results for RB and all NBs into a Single DataFrame respectively<a class="headerlink" href="#Combine-Unit-Results-for-RB-and-all-NBs-into-a-Single-DataFrame-respectively" title="Link to this heading"></a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Concatenate all DataFrames in rb_mod for each unit into a single DataFrame, ignoring the index</span>
<span class="n">rbdf</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">rb_mod</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_units</span><span class="p">)],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Initialize an empty list to hold the concatenated DataFrames for each board</span>
<span class="n">nbdf</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># Loop through each board to concatenate the results for all units</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_boards</span><span class="p">):</span>
    <span class="c1"># Concatenate all DataFrames in nb_mod for the current board across all units, ignoring the index</span>
    <span class="n">temp</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">nb_mod</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_units</span><span class="p">)],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># Append the concatenated DataFrame for the current board to the nbdf list</span>
    <span class="n">nbdf</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="Calculate-Mean-for-RB-and-all-NBs-for-DataFrames">
<h3>Calculate Mean for RB and all NBs for DataFrames<a class="headerlink" href="#Calculate-Mean-for-RB-and-all-NBs-for-DataFrames" title="Link to this heading"></a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate the mean of the rbdf DataFrame, format it to four decimal places, and convert it to float</span>
<span class="n">meanrbdf</span> <span class="o">=</span> <span class="n">rbdf</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">x</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Initialize an empty list to hold the mean results for each board</span>
<span class="n">meannbdf</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># Loop through each board to calculate the mean of the corresponding DataFrame</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_boards</span><span class="p">):</span>
    <span class="c1"># Calculate the mean of the current board&#39;s DataFrame, format it to four decimal places, and convert it to float</span>
    <span class="n">temp</span> <span class="o">=</span> <span class="n">nbdf</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">x</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>

    <span class="c1"># Append the mean result for the current board to the meannbdf list</span>
    <span class="n">meannbdf</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>

<span class="c1"># Reset the index for each DataFrame in the meannbdf list</span>
<span class="n">meannbdf</span> <span class="o">=</span> <span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">for</span> <span class="n">df</span> <span class="ow">in</span> <span class="n">meannbdf</span><span class="p">]</span>
</pre></div>
</div>
</div>
</section>
<section id="Calculate-Standard-Deviation-for-RB-and-all-NBs-for-DataFrames">
<h3>Calculate Standard Deviation for RB and all NBs for DataFrames<a class="headerlink" href="#Calculate-Standard-Deviation-for-RB-and-all-NBs-for-DataFrames" title="Link to this heading"></a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate the standard deviation of the rbdf DataFrame, format it to four decimal places, and convert it to float</span>
<span class="n">stdrbdf</span> <span class="o">=</span> <span class="n">rbdf</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">ddof</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">x</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Initialize an empty list to hold the standard deviation results for each board</span>
<span class="n">stdnbdf</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># Loop through each board to calculate the standard deviation of the corresponding DataFrame</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_boards</span><span class="p">):</span>
    <span class="c1"># Calculate the standard deviation of the current board&#39;s DataFrame, format it to four decimal places, and convert it to float</span>
    <span class="n">temp</span> <span class="o">=</span> <span class="n">nbdf</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">ddof</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">x</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>

    <span class="c1"># Append the standard deviation result for the current board to the stdnbdf list</span>
    <span class="n">stdnbdf</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>

<span class="c1"># Reset the index for each DataFrame in the stdnbdf list</span>
<span class="n">stdnbdf</span> <span class="o">=</span> <span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">for</span> <span class="n">df</span> <span class="ow">in</span> <span class="n">stdnbdf</span><span class="p">]</span>
</pre></div>
</div>
</div>
</section>
<section id="Combine-Mean-and-Standard-Deviation-for-RB-and-NBs">
<h3>Combine Mean and Standard Deviation for RB and NBs<a class="headerlink" href="#Combine-Mean-and-Standard-Deviation-for-RB-and-NBs" title="Link to this heading"></a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Concatenate the mean and standard deviation DataFrames for rbdf along the columns, ignoring the index</span>
<span class="n">meanstdrbdf</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">meanrbdf</span><span class="p">,</span> <span class="n">stdrbdf</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Set the column names for the concatenated DataFrame</span>
<span class="n">meanstdrbdf</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Mean RB&#39;</span><span class="p">,</span> <span class="s1">&#39;SD RB&#39;</span><span class="p">]</span>

<span class="c1"># Initialize a list to hold the concatenated mean and standard deviation DataFrames for each board</span>
<span class="n">meanstdnbdf</span> <span class="o">=</span> <span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_boards</span><span class="p">)]</span>

<span class="c1"># Loop through each board to concatenate the mean and standard deviation DataFrames</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_boards</span><span class="p">):</span>
    <span class="c1"># Concatenate the mean and standard deviation DataFrames for the current board along the columns, ignoring the index</span>
    <span class="n">meanstdnbdf</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">meannbdf</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">stdnbdf</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># Set the column names for the concatenated DataFrame of the current board</span>
    <span class="n">meanstdnbdf</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;Mean NB</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;SD NB</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</section>
<section id="Calculate-Cp-and-Cpk-for-RB">
<h3>Calculate Cp and Cpk for RB<a class="headerlink" href="#Calculate-Cp-and-Cpk-for-RB" title="Link to this heading"></a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Concatenate the limit DataFrame with the mean and standard deviation DataFrame for rbdf along the columns</span>
<span class="n">rbcpcpk</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">limit</span><span class="p">,</span> <span class="n">meanstdrbdf</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Apply the calculate_cp_rb function to each row of the concatenated DataFrame to calculate the Cp value for rb</span>
<span class="n">rbcpcpk</span><span class="p">[</span><span class="s2">&quot;Cp RB&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rbcpcpk</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">calculate_cp_rb</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Apply the calculate_cpk_rb function to each row of the concatenated DataFrame to calculate the Cpk values</span>
<span class="c1"># The result is expanded into two new columns: &#39;Cpk RB&#39; and &#39;Cpk RB Result&#39;</span>
<span class="n">rbcpcpk</span><span class="p">[[</span><span class="s1">&#39;Cpk RB&#39;</span><span class="p">,</span> <span class="s1">&#39;Cpk RB Result&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">rbcpcpk</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">calculate_cpk_rb</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">result_type</span><span class="o">=</span><span class="s1">&#39;expand&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="Calculate-Cp-and-Cpk-for-NBs">
<h3>Calculate Cp and Cpk for NBs<a class="headerlink" href="#Calculate-Cp-and-Cpk-for-NBs" title="Link to this heading"></a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Initialize an empty list to hold the DataFrames for each board&#39;s Cp and Cpk results</span>
<span class="n">nbcpkresult</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># Loop through each board to concatenate the rbcpcpk DataFrame with the corresponding mean and standard deviation DataFrame</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_boards</span><span class="p">):</span>
    <span class="c1"># Concatenate the rbcpcpk DataFrame with the mean and standard deviation DataFrame for the current board</span>
    <span class="n">temp</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">rbcpcpk</span><span class="p">,</span> <span class="n">meanstdnbdf</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="c1"># Append the concatenated DataFrame to the nbcpkresult list</span>
    <span class="n">nbcpkresult</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>

<span class="c1"># Loop through each board to calculate the Cp values and add them to the corresponding DataFrame</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_boards</span><span class="p">):</span>
    <span class="c1"># Apply the calculate_cp_nb function to each row of the current board&#39;s DataFrame to calculate the Cp value</span>
    <span class="n">nbcpkresult</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="sa">f</span><span class="s2">&quot;Cp NB</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">nbcpkresult</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">calculate_cp_nb</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Loop through each board to calculate the Cpk values and add them to the corresponding DataFrame</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_boards</span><span class="p">):</span>
    <span class="c1"># Apply the calculate_cpk_nb function to each row of the current board&#39;s DataFrame to calculate the Cpk values</span>
    <span class="c1"># The result is expanded into two new columns: &#39;Cpk NB&#39; and &#39;Cpk NB Result&#39;</span>
    <span class="n">nbcpkresult</span><span class="p">[</span><span class="n">i</span><span class="p">][[</span><span class="sa">f</span><span class="s1">&#39;Cpk NB</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;Cpk NB</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s1"> Result&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">nbcpkresult</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">calculate_cpk_nb</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">result_type</span><span class="o">=</span><span class="s1">&#39;expand&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
</section>
<section id="Correlation-Result-Summary-Table">
<h2>Correlation Result Summary Table<a class="headerlink" href="#Correlation-Result-Summary-Table" title="Link to this heading"></a></h2>
<section id="Create-a-Correlation-Table-for-Test-Results-for-RB-and-all-NBs">
<h3>Create a Correlation Table for Test Results for RB and all NBs<a class="headerlink" href="#Create-a-Correlation-Table-for-Test-Results-for-RB-and-all-NBs" title="Link to this heading"></a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Initialize an empty DataFrame to hold the correlation table</span>
<span class="n">corrtable</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>

<span class="c1"># Creating corrtable and adding necessary columns</span>
<span class="c1"># Add a column for the test card names, formatted with the product info and board index</span>
<span class="n">corrtable</span><span class="p">[</span><span class="s1">&#39;Test Card&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">product_info</span><span class="p">[</span><span class="s1">&#39;Test Card Name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">_NB</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_boards</span><span class="p">)]</span>

<span class="c1"># Add a column for the count of passed tests across all units for each board</span>
<span class="n">corrtable</span><span class="p">[</span><span class="s1">&#39;Passed test all units&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">nb_results</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="sa">f</span><span class="s2">&quot;NB</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2"> Result&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;Passed&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_boards</span><span class="p">)]</span>

<span class="c1"># Add a column for the count of tests marked &#39;For check&#39; across all units for each board</span>
<span class="n">corrtable</span><span class="p">[</span><span class="s1">&#39;For Check test all units&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">nb_results</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="sa">f</span><span class="s2">&quot;NB</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2"> Result&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;For check&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_boards</span><span class="p">)]</span>

<span class="c1"># Add a column for the count of failed tests across all units for each board</span>
<span class="n">corrtable</span><span class="p">[</span><span class="s1">&#39;Failed test all units&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">nb_results</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="sa">f</span><span class="s2">&quot;NB</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2"> Result&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;Failed&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_boards</span><span class="p">)]</span>

<span class="c1"># Adding unit-specific columns for each unit</span>
<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_units</span><span class="p">):</span>
    <span class="c1"># Add a column for the count of passed tests for the current unit across all boards</span>
    <span class="n">corrtable</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;Passed test U</span><span class="si">{</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">nb_results</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="sa">f</span><span class="s2">&quot;Result NB</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2"> U</span><span class="si">{</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;Passed&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_boards</span><span class="p">)]</span>

    <span class="c1"># Add a column for the count of tests marked &#39;For check&#39; for the current unit across all boards</span>
    <span class="n">corrtable</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;For Check test U</span><span class="si">{</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">nb_results</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="sa">f</span><span class="s2">&quot;Result NB</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2"> U</span><span class="si">{</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;For check&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_boards</span><span class="p">)]</span>

    <span class="c1"># Add a column for the count of failed tests for the current unit across all boards</span>
    <span class="n">corrtable</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;Failed test U</span><span class="si">{</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">nb_results</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="sa">f</span><span class="s2">&quot;Result NB</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2"> U</span><span class="si">{</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;Failed&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_boards</span><span class="p">)]</span>

<span class="c1"># Add a column for the total number of tests conducted (assuming all boards have the same number of results)</span>
<span class="n">corrtable</span><span class="p">[</span><span class="s1">&#39;Total test&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">nb_results</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

<span class="c1"># Apply a function to check values and add remarks to the DataFrame</span>
<span class="n">corrtable</span><span class="p">[</span><span class="s1">&#39;Remarks&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">corrtable</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">check_value</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Set the &#39;Test Card&#39; column as the index of the DataFrame</span>
<span class="n">corrtable</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;Test Card&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Transpose the DataFrame to switch rows and columns</span>
<span class="n">corrtable</span> <span class="o">=</span> <span class="n">corrtable</span><span class="o">.</span><span class="n">T</span>

<span class="c1"># Optional: Rename the axes for clarity</span>
<span class="n">corrtable</span><span class="o">.</span><span class="n">rename_axis</span><span class="p">(</span><span class="s2">&quot;Test Card&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">corrtable</span><span class="o">.</span><span class="n">rename_axis</span><span class="p">(</span><span class="s2">&quot;Index&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Reset the index to convert the index back into a column</span>
<span class="n">corrtable</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<br/></pre></div>
</div>
</div>
</section>
<section id="Create-DataFrames-from-Product-and-Setup-Information">
<h3>Create DataFrames from Product and Setup Information<a class="headerlink" href="#Create-DataFrames-from-Product-and-Setup-Information" title="Link to this heading"></a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a DataFrame from the product_info dictionary, using the index as the first column and &#39;Details&#39; as the second column</span>
<span class="n">df_product_info</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">product_info</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Details&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>

<span class="c1"># Create a DataFrame from the setup_info dictionary, using the index as the first column and &#39;Details&#39; as the second column</span>
<span class="n">df_setup_info</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">setup_info</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Details&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>

<span class="c1"># Rename the columns of the product info DataFrame for clarity</span>
<span class="n">df_product_info</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Product Info&#39;</span><span class="p">,</span> <span class="s1">&#39;Details&#39;</span><span class="p">]</span>

<span class="c1"># Rename the columns of the setup info DataFrame for clarity</span>
<span class="n">df_setup_info</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Setup Info&#39;</span><span class="p">,</span> <span class="s1">&#39;Details&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</section>
</section>
<section id="Generate-output-file">
<h2>Generate output file<a class="headerlink" href="#Generate-output-file" title="Link to this heading"></a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define the output file name for the Excel report, incorporating the test card name and the current date</span>

<span class="n">current_date</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%d</span><span class="s2">-%m-%Y&quot;</span><span class="p">)</span>  <span class="c1"># Get the current date in YYYY-MM-DD format</span>

<span class="n">output_file</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">product_info</span><span class="p">[</span><span class="s2">&quot;Test Card Name&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1">_Correlation_Report_</span><span class="si">{</span><span class="n">current_date</span><span class="si">}</span><span class="s1">.xlsx&#39;</span>

<span class="c1"># Create an Excel writer object to write multiple DataFrames to an Excel file</span>
<span class="k">with</span> <span class="n">pd</span><span class="o">.</span><span class="n">ExcelWriter</span><span class="p">(</span><span class="n">output_file</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="s1">&#39;openpyxl&#39;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">writer</span><span class="p">:</span>
    <span class="c1"># Write additional DataFrames to specific sheets first</span>
    <span class="n">df_product_info</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;Info&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>  <span class="c1"># Write product info to &#39;Info&#39; sheet</span>
    <span class="n">df_setup_info</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;Info&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">startrow</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">df_product_info</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># Write setup info below product info</span>
    <span class="n">corrtable</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;Correlation Summary&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>  <span class="c1"># Write correlation summary to its own sheet</span>

    <span class="c1"># Write the first set of DataFrames (rb_nbu) to separate sheets</span>
    <span class="k">for</span> <span class="n">row_index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">rb_nbu</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">col_index</span><span class="p">,</span> <span class="n">df</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">row</span><span class="p">):</span>
            <span class="n">sheet_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;NB</span><span class="si">{</span><span class="n">row_index</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s1"> U</span><span class="si">{</span><span class="n">col_index</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s1"> Corr&#39;</span>  <span class="c1"># Create a sheet name based on the row and column index</span>
            <span class="n">df</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="n">sheet_name</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>  <span class="c1"># Write the DataFrame to the specified sheet</span>
            <span class="n">worksheet</span> <span class="o">=</span> <span class="n">writer</span><span class="o">.</span><span class="n">sheets</span><span class="p">[</span><span class="n">sheet_name</span><span class="p">]</span>  <span class="c1"># Access the worksheet for further formatting</span>

    <span class="c1"># Apply conditional formatting for specific criteria in the worksheets</span>
    <span class="k">for</span> <span class="n">row_index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">rb_nbu</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">col_index</span><span class="p">,</span> <span class="n">df</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">row</span><span class="p">):</span>
            <span class="n">sheet_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;NB</span><span class="si">{</span><span class="n">row_index</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s1"> U</span><span class="si">{</span><span class="n">col_index</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s1"> Corr&#39;</span>
            <span class="n">df</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="n">sheet_name</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="n">worksheet</span> <span class="o">=</span> <span class="n">writer</span><span class="o">.</span><span class="n">sheets</span><span class="p">[</span><span class="n">sheet_name</span><span class="p">]</span>

            <span class="c1"># Apply PatternFill for `Mean Shift Criteria` and `SD Ratio Criteria`</span>
            <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">cell</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">worksheet</span><span class="p">[</span><span class="s1">&#39;M&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">:],</span> <span class="n">start</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>  <span class="c1"># Column M: Mean Shift Criteria</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">value</span>
                <span class="k">if</span> <span class="n">value</span> <span class="o">==</span> <span class="s2">&quot;Passed&quot;</span><span class="p">:</span>
                    <span class="n">cell</span><span class="o">.</span><span class="n">fill</span> <span class="o">=</span> <span class="n">PatternFill</span><span class="p">(</span><span class="n">start_color</span><span class="o">=</span><span class="s2">&quot;78e08f&quot;</span><span class="p">,</span> <span class="n">end_color</span><span class="o">=</span><span class="s2">&quot;78e08f&quot;</span><span class="p">,</span> <span class="n">fill_type</span><span class="o">=</span><span class="s2">&quot;solid&quot;</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">value</span> <span class="o">==</span> <span class="s2">&quot;For check&quot;</span><span class="p">:</span>
                    <span class="n">cell</span><span class="o">.</span><span class="n">fill</span> <span class="o">=</span> <span class="n">PatternFill</span><span class="p">(</span><span class="n">start_color</span><span class="o">=</span><span class="s2">&quot;feca57&quot;</span><span class="p">,</span> <span class="n">end_color</span><span class="o">=</span><span class="s2">&quot;feca57&quot;</span><span class="p">,</span> <span class="n">fill_type</span><span class="o">=</span><span class="s2">&quot;solid&quot;</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">value</span> <span class="o">==</span> <span class="s2">&quot;Failed&quot;</span><span class="p">:</span>
                    <span class="n">cell</span><span class="o">.</span><span class="n">fill</span> <span class="o">=</span> <span class="n">PatternFill</span><span class="p">(</span><span class="n">start_color</span><span class="o">=</span><span class="s2">&quot;ea8685&quot;</span><span class="p">,</span> <span class="n">end_color</span><span class="o">=</span><span class="s2">&quot;ea8685&quot;</span><span class="p">,</span> <span class="n">fill_type</span><span class="o">=</span><span class="s2">&quot;solid&quot;</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">cell</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">worksheet</span><span class="p">[</span><span class="s1">&#39;O&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">:],</span> <span class="n">start</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>  <span class="c1"># Column O: SD Ratio Criteria</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">value</span>
                <span class="k">if</span> <span class="n">value</span> <span class="o">==</span> <span class="s2">&quot;Passed&quot;</span><span class="p">:</span>
                    <span class="n">cell</span><span class="o">.</span><span class="n">fill</span> <span class="o">=</span> <span class="n">PatternFill</span><span class="p">(</span><span class="n">start_color</span><span class="o">=</span><span class="s2">&quot;78e08f&quot;</span><span class="p">,</span> <span class="n">end_color</span><span class="o">=</span><span class="s2">&quot;78e08f&quot;</span><span class="p">,</span> <span class="n">fill_type</span><span class="o">=</span><span class="s2">&quot;solid&quot;</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">value</span> <span class="o">==</span> <span class="s2">&quot;For check&quot;</span><span class="p">:</span>
                    <span class="n">cell</span><span class="o">.</span><span class="n">fill</span> <span class="o">=</span> <span class="n">PatternFill</span><span class="p">(</span><span class="n">start_color</span><span class="o">=</span><span class="s2">&quot;feca57&quot;</span><span class="p">,</span> <span class="n">end_color</span><span class="o">=</span><span class="s2">&quot;feca57&quot;</span><span class="p">,</span> <span class="n">fill_type</span><span class="o">=</span><span class="s2">&quot;solid&quot;</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">value</span> <span class="o">==</span> <span class="s2">&quot;Failed&quot;</span><span class="p">:</span>
                    <span class="n">cell</span><span class="o">.</span><span class="n">fill</span> <span class="o">=</span> <span class="n">PatternFill</span><span class="p">(</span><span class="n">start_color</span><span class="o">=</span><span class="s2">&quot;ea8685&quot;</span><span class="p">,</span> <span class="n">end_color</span><span class="o">=</span><span class="s2">&quot;ea8685&quot;</span><span class="p">,</span> <span class="n">fill_type</span><span class="o">=</span><span class="s2">&quot;solid&quot;</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">cell</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">worksheet</span><span class="p">[</span><span class="s1">&#39;P&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">:],</span> <span class="n">start</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>  <span class="c1"># Column P: SD Ratio Criteria</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">value</span>
                <span class="k">if</span> <span class="n">value</span> <span class="o">==</span> <span class="s2">&quot;Passed&quot;</span><span class="p">:</span>
                    <span class="n">cell</span><span class="o">.</span><span class="n">fill</span> <span class="o">=</span> <span class="n">PatternFill</span><span class="p">(</span><span class="n">start_color</span><span class="o">=</span><span class="s2">&quot;78e08f&quot;</span><span class="p">,</span> <span class="n">end_color</span><span class="o">=</span><span class="s2">&quot;78e08f&quot;</span><span class="p">,</span> <span class="n">fill_type</span><span class="o">=</span><span class="s2">&quot;solid&quot;</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">value</span> <span class="o">==</span> <span class="s2">&quot;For check&quot;</span><span class="p">:</span>
                    <span class="n">cell</span><span class="o">.</span><span class="n">fill</span> <span class="o">=</span> <span class="n">PatternFill</span><span class="p">(</span><span class="n">start_color</span><span class="o">=</span><span class="s2">&quot;feca57&quot;</span><span class="p">,</span> <span class="n">end_color</span><span class="o">=</span><span class="s2">&quot;feca57&quot;</span><span class="p">,</span> <span class="n">fill_type</span><span class="o">=</span><span class="s2">&quot;solid&quot;</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">value</span> <span class="o">==</span> <span class="s2">&quot;Failed&quot;</span><span class="p">:</span>
                    <span class="n">cell</span><span class="o">.</span><span class="n">fill</span> <span class="o">=</span> <span class="n">PatternFill</span><span class="p">(</span><span class="n">start_color</span><span class="o">=</span><span class="s2">&quot;ea8685&quot;</span><span class="p">,</span> <span class="n">end_color</span><span class="o">=</span><span class="s2">&quot;ea8685&quot;</span><span class="p">,</span> <span class="n">fill_type</span><span class="o">=</span><span class="s2">&quot;solid&quot;</span><span class="p">)</span>

    <span class="c1"># Write the third set of DataFrames (nbtrueresult) to separate sheets</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">df</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">nbtrueresult</span><span class="p">):</span>
        <span class="n">sheet_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;NB</span><span class="si">{</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s1"> Results&#39;</span>  <span class="c1"># Create a sheet name for the results</span>
        <span class="n">df</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="n">sheet_name</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>  <span class="c1"># Write the DataFrame to the specified sheet</span>
        <span class="n">worksheet</span> <span class="o">=</span> <span class="n">writer</span><span class="o">.</span><span class="n">sheets</span><span class="p">[</span><span class="n">sheet_name</span><span class="p">]</span>  <span class="c1"># Access the worksheet for further formatting</span>

        <span class="c1"># Apply PatternFill for `Result NB# U#`</span>
        <span class="k">for</span> <span class="n">col_index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)):</span>  <span class="c1"># Dynamic column range</span>
            <span class="k">if</span> <span class="n">col_index</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># Exclude the last &quot;NB# Result&quot; column</span>
                <span class="n">column_letter</span> <span class="o">=</span> <span class="n">get_column_letter</span><span class="p">(</span><span class="n">col_index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="n">worksheet</span><span class="p">[</span><span class="n">column_letter</span><span class="p">][</span><span class="mi">1</span><span class="p">:]:</span>  <span class="c1"># Exclude header row</span>
                    <span class="n">value</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">value</span>
                    <span class="k">if</span> <span class="n">value</span> <span class="o">==</span> <span class="s2">&quot;Passed&quot;</span><span class="p">:</span>
                        <span class="n">cell</span><span class="o">.</span><span class="n">fill</span> <span class="o">=</span> <span class="n">PatternFill</span><span class="p">(</span><span class="n">start_color</span><span class="o">=</span><span class="s2">&quot;78e08f&quot;</span><span class="p">,</span> <span class="n">end_color</span><span class="o">=</span><span class="s2">&quot;78e08f&quot;</span><span class="p">,</span> <span class="n">fill_type</span><span class="o">=</span><span class="s2">&quot;solid&quot;</span><span class="p">)</span>
                    <span class="k">elif</span> <span class="n">value</span> <span class="o">==</span> <span class="s2">&quot;For check&quot;</span><span class="p">:</span>
                        <span class="n">cell</span><span class="o">.</span><span class="n">fill</span> <span class="o">=</span> <span class="n">PatternFill</span><span class="p">(</span><span class="n">start_color</span><span class="o">=</span><span class="s2">&quot;feca57&quot;</span><span class="p">,</span> <span class="n">end_color</span><span class="o">=</span><span class="s2">&quot;feca57&quot;</span><span class="p">,</span> <span class="n">fill_type</span><span class="o">=</span><span class="s2">&quot;solid&quot;</span><span class="p">)</span>
                    <span class="k">elif</span> <span class="n">value</span> <span class="o">==</span> <span class="s2">&quot;Failed&quot;</span><span class="p">:</span>
                        <span class="n">cell</span><span class="o">.</span><span class="n">fill</span> <span class="o">=</span> <span class="n">PatternFill</span><span class="p">(</span><span class="n">start_color</span><span class="o">=</span><span class="s2">&quot;ea8685&quot;</span><span class="p">,</span> <span class="n">end_color</span><span class="o">=</span><span class="s2">&quot;ea8685&quot;</span><span class="p">,</span> <span class="n">fill_type</span><span class="o">=</span><span class="s2">&quot;solid&quot;</span><span class="p">)</span>

        <span class="c1"># Apply PatternFill for `NB# Result` (last column)</span>
        <span class="n">result_column_letter</span> <span class="o">=</span> <span class="n">get_column_letter</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">))</span>  <span class="c1"># Last column for &quot;NB# Result&quot;</span>
        <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="n">worksheet</span><span class="p">[</span><span class="n">result_column_letter</span><span class="p">][</span><span class="mi">1</span><span class="p">:]:</span>  <span class="c1"># Exclude header row</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">value</span>
            <span class="k">if</span> <span class="n">value</span> <span class="o">==</span> <span class="s2">&quot;Passed&quot;</span><span class="p">:</span>
                <span class="n">cell</span><span class="o">.</span><span class="n">fill</span> <span class="o">=</span> <span class="n">PatternFill</span><span class="p">(</span><span class="n">start_color</span><span class="o">=</span><span class="s2">&quot;78e08f&quot;</span><span class="p">,</span> <span class="n">end_color</span><span class="o">=</span><span class="s2">&quot;78e08f&quot;</span><span class="p">,</span> <span class="n">fill_type</span><span class="o">=</span><span class="s2">&quot;solid&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">value</span> <span class="o">==</span> <span class="s2">&quot;For check&quot;</span><span class="p">:</span>
                <span class="n">cell</span><span class="o">.</span><span class="n">fill</span> <span class="o">=</span> <span class="n">PatternFill</span><span class="p">(</span><span class="n">start_color</span><span class="o">=</span><span class="s2">&quot;feca57&quot;</span><span class="p">,</span> <span class="n">end_color</span><span class="o">=</span><span class="s2">&quot;feca57&quot;</span><span class="p">,</span> <span class="n">fill_type</span><span class="o">=</span><span class="s2">&quot;solid&quot;</span><span class="p">)</span>

    <span class="c1"># Write the second set of DataFrames (nbcpkresult) to separate sheets</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">df</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">nbcpkresult</span><span class="p">):</span>
        <span class="n">sheet_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;NB</span><span class="si">{</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s1"> CPK&#39;</span>  <span class="c1"># Create a sheet name for CPK results</span>
        <span class="n">df</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="n">sheet_name</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>  <span class="c1"># Write the DataFrame to the specified sheet</span>
        <span class="n">worksheet</span> <span class="o">=</span> <span class="n">writer</span><span class="o">.</span><span class="n">sheets</span><span class="p">[</span><span class="n">sheet_name</span><span class="p">]</span>  <span class="c1"># Access the worksheet for further formatting</span>

        <span class="c1"># Apply PatternFill for `Cpk RB Result` and `Cpk NB# Result`</span>
        <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">cell</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">worksheet</span><span class="p">[</span><span class="s1">&#39;K&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">:],</span> <span class="n">start</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>  <span class="c1"># Column K</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">value</span>
            <span class="k">if</span> <span class="n">value</span> <span class="o">==</span> <span class="s2">&quot;Good capable&quot;</span><span class="p">:</span>
                <span class="n">cell</span><span class="o">.</span><span class="n">fill</span> <span class="o">=</span> <span class="n">PatternFill</span><span class="p">(</span><span class="n">start_color</span><span class="o">=</span><span class="s2">&quot;78e08f&quot;</span><span class="p">,</span> <span class="n">end_color</span><span class="o">=</span><span class="s2">&quot;78e08f&quot;</span><span class="p">,</span> <span class="n">fill_type</span><span class="o">=</span><span class="s2">&quot;solid&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">value</span> <span class="o">==</span> <span class="s2">&quot;Not capable&quot;</span><span class="p">:</span>
                <span class="n">cell</span><span class="o">.</span><span class="n">fill</span> <span class="o">=</span> <span class="n">PatternFill</span><span class="p">(</span><span class="n">start_color</span><span class="o">=</span><span class="s2">&quot;ea8685&quot;</span><span class="p">,</span> <span class="n">end_color</span><span class="o">=</span><span class="s2">&quot;ea8685&quot;</span><span class="p">,</span> <span class="n">fill_type</span><span class="o">=</span><span class="s2">&quot;solid&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">value</span> <span class="o">==</span> <span class="s2">&quot;N/A&quot;</span><span class="p">:</span>
                <span class="n">cell</span><span class="o">.</span><span class="n">fill</span> <span class="o">=</span> <span class="n">PatternFill</span><span class="p">(</span><span class="n">start_color</span><span class="o">=</span><span class="s2">&quot;95afc0&quot;</span><span class="p">,</span> <span class="n">end_color</span><span class="o">=</span><span class="s2">&quot;95afc0&quot;</span><span class="p">,</span> <span class="n">fill_type</span><span class="o">=</span><span class="s2">&quot;solid&quot;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">cell</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">worksheet</span><span class="p">[</span><span class="s1">&#39;P&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">:],</span> <span class="n">start</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>  <span class="c1"># Column P</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">value</span>
            <span class="k">if</span> <span class="n">value</span> <span class="o">==</span> <span class="s2">&quot;Good capable&quot;</span><span class="p">:</span>
                <span class="n">cell</span><span class="o">.</span><span class="n">fill</span> <span class="o">=</span> <span class="n">PatternFill</span><span class="p">(</span><span class="n">start_color</span><span class="o">=</span><span class="s2">&quot;78e08f&quot;</span><span class="p">,</span> <span class="n">end_color</span><span class="o">=</span><span class="s2">&quot;78e08f&quot;</span><span class="p">,</span> <span class="n">fill_type</span><span class="o">=</span><span class="s2">&quot;solid&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">value</span> <span class="o">==</span> <span class="s2">&quot;Not capable&quot;</span><span class="p">:</span>
                <span class="n">cell</span><span class="o">.</span><span class="n">fill</span> <span class="o">=</span> <span class="n">PatternFill</span><span class="p">(</span><span class="n">start_color</span><span class="o">=</span><span class="s2">&quot;ea8685&quot;</span><span class="p">,</span> <span class="n">end_color</span><span class="o">=</span><span class="s2">&quot;ea8685&quot;</span><span class="p">,</span> <span class="n">fill_type</span><span class="o">=</span><span class="s2">&quot;solid&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">value</span> <span class="o">==</span> <span class="s2">&quot;N/A&quot;</span><span class="p">:</span>
                <span class="n">cell</span><span class="o">.</span><span class="n">fill</span> <span class="o">=</span> <span class="n">PatternFill</span><span class="p">(</span><span class="n">start_color</span><span class="o">=</span><span class="s2">&quot;95afc0&quot;</span><span class="p">,</span> <span class="n">end_color</span><span class="o">=</span><span class="s2">&quot;95afc0&quot;</span><span class="p">,</span> <span class="n">fill_type</span><span class="o">=</span><span class="s2">&quot;solid&quot;</span><span class="p">)</span>

    <span class="c1"># Access the workbook and the writer&#39;s worksheets</span>
    <span class="n">workbook</span> <span class="o">=</span> <span class="n">writer</span><span class="o">.</span><span class="n">book</span>

    <span class="c1"># Define a border style for the cells</span>
    <span class="n">thin_border</span> <span class="o">=</span> <span class="n">Border</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="n">Side</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s1">&#39;thin&#39;</span><span class="p">),</span>
                         <span class="n">right</span><span class="o">=</span><span class="n">Side</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s1">&#39;thin&#39;</span><span class="p">),</span>
                         <span class="n">top</span><span class="o">=</span><span class="n">Side</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s1">&#39;thin&#39;</span><span class="p">),</span>
                         <span class="n">bottom</span><span class="o">=</span><span class="n">Side</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s1">&#39;thin&#39;</span><span class="p">))</span>

    <span class="n">fill_color</span> <span class="o">=</span> <span class="n">PatternFill</span><span class="p">(</span><span class="n">start_color</span><span class="o">=</span><span class="s1">&#39;82ccdd&#39;</span><span class="p">,</span> <span class="n">end_color</span><span class="o">=</span><span class="s1">&#39;82ccdd&#39;</span><span class="p">,</span> <span class="n">fill_type</span><span class="o">=</span><span class="s1">&#39;solid&#39;</span><span class="p">)</span>
    <span class="n">fill_color_info</span> <span class="o">=</span> <span class="n">PatternFill</span><span class="p">(</span><span class="n">start_color</span><span class="o">=</span><span class="s1">&#39;74b9ff&#39;</span><span class="p">,</span> <span class="n">end_color</span><span class="o">=</span><span class="s1">&#39;74b9ff&#39;</span><span class="p">,</span> <span class="n">fill_type</span><span class="o">=</span><span class="s1">&#39;solid&#39;</span><span class="p">)</span>
    <span class="n">fill_color_corr</span> <span class="o">=</span> <span class="n">PatternFill</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>

    <span class="c1"># Adjust column widths, add autofilters, and apply formatting</span>
    <span class="k">for</span> <span class="n">sheet_name</span> <span class="ow">in</span> <span class="n">writer</span><span class="o">.</span><span class="n">sheets</span><span class="p">:</span>
        <span class="n">worksheet</span> <span class="o">=</span> <span class="n">workbook</span><span class="p">[</span><span class="n">sheet_name</span><span class="p">]</span>

        <span class="c1"># Adjust column widths for the current sheet</span>
        <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">worksheet</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="n">max_length</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">cell</span><span class="o">.</span><span class="n">value</span><span class="p">))</span> <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="n">column</span> <span class="k">if</span> <span class="n">cell</span><span class="o">.</span><span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span>
            <span class="n">adjusted_width</span> <span class="o">=</span> <span class="p">(</span><span class="n">max_length</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span>
            <span class="n">worksheet</span><span class="o">.</span><span class="n">column_dimensions</span><span class="p">[</span><span class="n">column</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">column_letter</span><span class="p">]</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="n">adjusted_width</span>

            <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="n">worksheet</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>  <span class="c1"># Access the first row</span>
                <span class="n">cell</span><span class="o">.</span><span class="n">fill</span> <span class="o">=</span> <span class="n">fill_color</span>  <span class="c1"># Apply the fill to each cell in the first row</span>

            <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="n">column</span><span class="p">:</span>
                <span class="n">cell</span><span class="o">.</span><span class="n">border</span> <span class="o">=</span> <span class="n">thin_border</span>  <span class="c1"># Apply border to each cell in the column</span>

        <span class="c1"># Add autofilter to all sheets except &#39;Info&#39;</span>
        <span class="k">if</span> <span class="n">sheet_name</span> <span class="o">!=</span> <span class="s1">&#39;Info&#39;</span><span class="p">:</span>
            <span class="n">worksheet</span><span class="o">.</span><span class="n">auto_filter</span><span class="o">.</span><span class="n">ref</span> <span class="o">=</span> <span class="n">worksheet</span><span class="o">.</span><span class="n">dimensions</span>

        <span class="c1"># Apply borders and formatting to specific sheets</span>
        <span class="k">if</span> <span class="n">sheet_name</span> <span class="o">==</span> <span class="s1">&#39;Info&#39;</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="n">worksheet</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>  <span class="c1"># Access the first row</span>
                <span class="n">cell</span><span class="o">.</span><span class="n">fill</span> <span class="o">=</span> <span class="n">fill_color_info</span>  <span class="c1"># Apply the fill to each cell in the first row</span>

            <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="n">worksheet</span><span class="p">[</span><span class="mi">8</span><span class="p">]:</span>  <span class="c1"># Access the eighth row</span>
                <span class="n">cell</span><span class="o">.</span><span class="n">fill</span> <span class="o">=</span> <span class="n">fill_color_info</span>  <span class="c1"># Apply the fill to each cell in the eighth row</span>

            <span class="c1"># Apply borders to the first table (df_product_info)</span>
            <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">worksheet</span><span class="o">.</span><span class="n">iter_rows</span><span class="p">(</span><span class="n">min_row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_row</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">df_product_info</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">min_col</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_col</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">df_product_info</span><span class="o">.</span><span class="n">columns</span><span class="p">)):</span>
                <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="n">row</span><span class="p">:</span>
                    <span class="n">cell</span><span class="o">.</span><span class="n">border</span> <span class="o">=</span> <span class="n">thin_border</span>  <span class="c1"># Apply border to each cell in the first table</span>

            <span class="c1"># Apply borders to the second table (df_setup_info)</span>
            <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">worksheet</span><span class="o">.</span><span class="n">iter_rows</span><span class="p">(</span><span class="n">min_row</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">df_product_info</span><span class="p">)</span> <span class="o">+</span> <span class="mi">3</span><span class="p">,</span> <span class="n">max_row</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">df_product_info</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">df_setup_info</span><span class="p">)</span> <span class="o">+</span> <span class="mi">3</span><span class="p">,</span> <span class="n">min_col</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_col</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">df_setup_info</span><span class="o">.</span><span class="n">columns</span><span class="p">)):</span>
                <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="n">row</span><span class="p">:</span>
                    <span class="n">cell</span><span class="o">.</span><span class="n">border</span> <span class="o">=</span> <span class="n">thin_border</span>  <span class="c1"># Apply border to each cell in the second table</span>

            <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="n">worksheet</span><span class="p">[</span><span class="mi">7</span><span class="p">]:</span>  <span class="c1"># Access the eighth row</span>
                <span class="n">cell</span><span class="o">.</span><span class="n">border</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># Remove border from the eighth row</span>

        <span class="k">if</span> <span class="n">sheet_name</span> <span class="o">==</span> <span class="s1">&#39;Correlation Summary&#39;</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">worksheet</span><span class="o">.</span><span class="n">iter_rows</span><span class="p">(</span><span class="n">min_row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_row</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">corrtable</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">min_col</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_col</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">corrtable</span><span class="o">.</span><span class="n">columns</span><span class="p">)):</span>
                <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="n">row</span><span class="p">:</span>
                    <span class="n">cell</span><span class="o">.</span><span class="n">border</span> <span class="o">=</span> <span class="n">thin_border</span>  <span class="c1"># Apply border to each cell in the correlation summary</span>
                    <span class="n">cell</span><span class="o">.</span><span class="n">fill</span> <span class="o">=</span> <span class="n">fill_color_corr</span>  <span class="c1"># Apply fill color to each cell</span>

                    <span class="c1"># Align all cells to the left</span>
                    <span class="n">cell</span><span class="o">.</span><span class="n">alignment</span> <span class="o">=</span> <span class="n">Alignment</span><span class="p">(</span><span class="n">horizontal</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>

                    <span class="c1"># Make the first column bold</span>
                    <span class="k">if</span> <span class="n">cell</span><span class="o">.</span><span class="n">column</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># Check if it&#39;s the first column</span>
                        <span class="n">cell</span><span class="o">.</span><span class="n">font</span> <span class="o">=</span> <span class="n">Font</span><span class="p">(</span><span class="n">bold</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># Freeze the first row for all sheets except &#39;Info&#39; and &#39;Correlation Summary&#39;</span>
        <span class="k">if</span> <span class="n">sheet_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;Info&#39;</span><span class="p">,</span> <span class="s1">&#39;Correlation Summary&#39;</span><span class="p">]:</span>
            <span class="n">worksheet</span><span class="o">.</span><span class="n">freeze_panes</span> <span class="o">=</span> <span class="n">worksheet</span><span class="p">[</span><span class="s1">&#39;A2&#39;</span><span class="p">]</span>  <span class="c1"># Freeze the first row</span>

        <span class="c1"># Align the first column to the left for all sheets except &#39;Info&#39; and &#39;Correlation Summary&#39;</span>
        <span class="k">if</span> <span class="n">sheet_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;Info&#39;</span><span class="p">,</span> <span class="s1">&#39;Correlation Summary&#39;</span><span class="p">]:</span>
            <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="n">worksheet</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">:]:</span>  <span class="c1"># Access the first column (A), excluding the header</span>
                <span class="n">cell</span><span class="o">.</span><span class="n">alignment</span> <span class="o">=</span> <span class="n">Alignment</span><span class="p">(</span><span class="n">horizontal</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>  <span class="c1"># Set alignment to left</span>

<span class="c1"># Print a message indicating that the DataFrames have been written to the specified output file</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Report have been written to &#39;</span><span class="si">{</span><span class="n">output_file</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<section id="Display-thank-you-and-countdown-timer-with-exit">
<h3>Display thank you and countdown timer with exit<a class="headerlink" href="#Display-thank-you-and-countdown-timer-with-exit" title="Link to this heading"></a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set the timer duration in seconds</span>
<span class="n">timer_duration</span> <span class="o">=</span> <span class="mi">10</span>  <span class="c1"># Change this to your desired duration</span>

<span class="c1"># Call the thank_you function to display a message or perform an action</span>
<span class="n">thank_you</span><span class="p">()</span>

<span class="c1"># Countdown loop to display the remaining time</span>
<span class="k">for</span> <span class="n">remaining</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">timer_duration</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
    <span class="c1"># Print the remaining time, overwriting the same line in the terminal</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The terminal will close in </span><span class="si">{</span><span class="n">remaining</span><span class="si">}</span><span class="s2"> seconds...&quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\r</span><span class="s1">&#39;</span><span class="p">)</span>  <span class="c1"># Use &#39;\r&#39; to overwrite the line</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># Pause execution for 1 second</span>

<span class="c1"># Exit the program after the countdown is complete</span>
<span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>
</pre></div>
</div>
</div>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="methodology.html" class="btn btn-neutral float-left" title="Methodology" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="flowchart.html" class="btn btn-neutral float-right" title="Flowchart Documentation" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Mohamad Haikal bin Mohamad Nazari.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>